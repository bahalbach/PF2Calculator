{"version":3,"sources":["defaults.js","types.js","Target/weaknessSlice.js","Target/targetSlice.js","Target/TargetInput.js","Calculation/Distribution.js","Routine/damageSlice.js","Routine/activityPathSlice.js","Routine/routineSlice.js","Calculation/Calculation.js","Calculation/EvaluateActivityPath.js","Display/Display.js","Routine/SelectedRoutine.js","Routines.js","Export.js","PF2App.js","Routine/effectSlice.js","store.js","serviceWorker.js","index.js"],"names":["graphTypes","DISTRIBUTION","PMDEFENSE","BYLEVEL","activityTypes","STRIKE","SAVE","defaultActivities","FIGHTER","MARTIAL","CASTER","ALCH","FIGHTERR","MARTIALR","CASTERR","ALCHR","CASTERCA","CASTERCS","CASTERBR","CASTERSA","CASTERS","defaultValuesAC","LOW","MODERATE","HIGH","EXTREME","defaultValuesSaves","TERRIBLE","defenses","AC","FORT","REF","WILL","PER","MAPs","N1","N2","N3","A1","A2","A3","R1","R2","R3","RA1","RA2","RA3","RAA1","RAA2","RAA3","nextMAPs","MAPvalues","rollTypes","NORMAL","ADVANTAGE","DISADVANTAGE","damageTypes","NONE","B","P","S","FIRE","materials","COLD_IRON","SILVER","ADAMANTINE","conditions","ALWAYS","CRIT","SUCC","FAIL","CRIF","AT_LEAST_SUCC","AT_LEAST_FAIL","FAIL_WORSE","SUCC_WORSE","dCond","BASIC","defaultTypes","defaultTargetTypes","defaultDamageConditions","CASTERC","zero","maxScore","score16","martialProf","alchProf","casterProf","spellProf","weaponItem","weaponDice","spellDice","spellDice2","i","Math","floor","martialSpec","casterSpec","fighterAB","martialAB","casterAB","alchAB","casterSpellAttack","casterSaveDC","fighterStatic","fighterRanged","martialStatic","martialRanged","casterStatic","casterRanged","defaultValues","defaultDiceNum","defaultStatic","extremeAC","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","highAC","level","moderateAC","lowAC","defaultACs","defaultSaves","weaknessAdapter","createEntityAdapter","weakness","weaknessesSlice","createSlice","name","initialState","getInitialState","reducers","weaknessAdded","addOne","weaknessUpdated","updateOne","weaknessCreated","reducer","state","action","payload","id","type","value","prepare","parentId","weaknessRemoved","removeOne","actions","getSelectors","weaknesses","selectweaknessById","selectById","selectweaknessEntities","selectIds","selectEntities","targetAdapter","selectAll","selectTotal","targetsSlice","targetAdded","targetUpdated","changes","match","target","entities","useDefaultAC","defaultAC","useDefaultFort","defaultFort","useDefaultRef","defaultRef","useDefaultWill","defaultWill","useDefaultPer","defaultPer","extraReducers","builder","addCase","weaknessId","push","filter","wid","targets","selecttargetById","selecttargetEntities","Weakness","useSelector","dispatch","useDispatch","className","onChange","e","isNaN","parseInt","AddWeakness","useState","weaknessValue","setWeaknessValue","WeaknessSelect","options","dt","key","m","TargetInput","matchRoutines","levelDiff","Fort","Ref","Will","Perception","flatfooted","ACOptions","dv","SaveOptions","htmlFor","placeholder","checked","map","convolve","vec1","vec2","length","Error","volume","kernel","displacement","convVec","j","consolidateDists","maxDamage","dists","dist","max","staticDamage","damageDist","index","applyMin","min","shift","damageAdapter","damageId","damagesSlice","damageAdded","damageUpdated","damageCreated","damageCondition","diceNum","diceSize","damageType","material","persistent","damageRemoved","damages","selectdamageById","selectdamageEntities","setDefault","apId","setChildren","applyDefault","ap","override","defaultActivity","targetType","apIds","activityPathAdapter","activityPathId","defaultParentActivity","useDefault","MAP","activityPathsSlice","activityPathAdded","activityPathUpdated","activityPathRemoved","undefined","activityPathCreated","parentAP","applyMAP","condition","targetInfoId","effects","routineId","did","ids","activityPaths","selectactivityPathById","selectactivityPathEntities","routinesAdapter","routinesSlice","selectedRoutine","setRoutine","routineAdded","routineUpdated","routineRemoved","routineCreated","display","updateSelected","routines","selectRoutineById","selectRoutineEntities","selectAllRoutines","selectSelectedRoutine","addDamage","context","multiplier","normal","dam","newDist","newDam","oldValue","chance","newValue","diff","multiplyDist","ActivityPathEvaluator","this","activityPath","defenseBonus","currentTarget","currentDamages","currentWeaknesses","activity","bonus","DC","console","log","critPercent","keen","dif","getCritSuccessPercent","succPercent","getSuccessPercent","failPercent","getFailurePercent","crfaPercent","getCritFailurePercent","rollType","notcrit","nothit","notfail","notcrfa","notsucc","chances","critDamages","succDamages","failDamages","crfaDamages","damageTrees","forEach","damage","diceArray","damageTree","damageQuality","totalStaticDamage","totalDamageDist","maxW","maxR","calculateExpectedDamage","evalPath","pathDist","pathPDist","indicies","Plot","createPlotlyComponent","Plotly","Display","addPersistent","setAddPersistent","graphType","setGraphType","title","evaluator","minbonus","maxbonus","maxPDamage","datasets","perDatasets","expectedDamages","expectedPersistentDamages","routine","bonusArray","expDbyBonus","expPDbyBonus","expD","expP","routineDDist","routinePDDist","PdamageDist","dataArray","cumulative","PdataArray","Pcumulative","currentSum","toFixed","x","y","yaxis","xtitle","ytitle","labels","Plabels","damageChart","classname","data","layout","autosize","xaxis","legend","xanchor","margin","l","r","useResizeHandler","style","width","height","persistentDamageChart","graphTypeOptions","gt","conditionOptions","c","defaultActivityOptions","da","activityTypeOptions","at","MAPOptions","defenseOptions","d","rollOptions","rt","damageConditionOptions","dc","diceNumOptions","dn","diceSizeOptions","ds","damageTypeOptions","materialOptions","NameInput","ActivityPath","displayCondition","onClick","Damage","SelectedRoutine","Routines","routineOptions","routineDisplays","ImportExport","PF2App","props","Export","effectAdapter","effectsSlice","effectAdded","effectUpdated","store","configureStore","routineReducer","activityPathReducer","damageReducer","effectReducer","weaknessReducer","targetReducer","overrideDefault","addMods","Boolean","window","location","hostname","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.91231630.chunk.js","sourcesContent":["import {\r\n  activityTypes,\r\n  dCond,\r\n  defaultActivities,\r\n  defaultValuesAC,\r\n  defaultValuesSaves,\r\n  defenses,\r\n} from \"./types\";\r\n\r\nexport const defaultTypes = {\r\n  [defaultActivities.FIGHTER]: activityTypes.STRIKE,\r\n  [defaultActivities.MARTIAL]: activityTypes.STRIKE,\r\n  [defaultActivities.CASTER]: activityTypes.STRIKE,\r\n  [defaultActivities.ALCH]: activityTypes.STRIKE,\r\n  [defaultActivities.FIGHTERR]: activityTypes.STRIKE,\r\n  [defaultActivities.MARTIALR]: activityTypes.STRIKE,\r\n  [defaultActivities.CASTERR]: activityTypes.STRIKE,\r\n  [defaultActivities.ALCHR]: activityTypes.STRIKE,\r\n  [defaultActivities.CASTERCA]: activityTypes.STRIKE,\r\n  [defaultActivities.CASTERCS]: activityTypes.SAVE,\r\n  [defaultActivities.CASTERSA]: activityTypes.STRIKE,\r\n  [defaultActivities.CASTERS]: activityTypes.SAVE,\r\n  [defaultActivities.CASTERBR]: activityTypes.SAVE,\r\n};\r\n\r\nexport const defaultTargetTypes = {\r\n  [defaultActivities.FIGHTER]: defenses.AC,\r\n  [defaultActivities.MARTIAL]: defenses.AC,\r\n  [defaultActivities.CASTER]: defenses.AC,\r\n  [defaultActivities.ALCH]: defenses.AC,\r\n  [defaultActivities.FIGHTERR]: defenses.AC,\r\n  [defaultActivities.MARTIALR]: defenses.AC,\r\n  [defaultActivities.CASTERR]: defenses.AC,\r\n  [defaultActivities.ALCHR]: defenses.AC,\r\n  [defaultActivities.CASTERCA]: defenses.AC,\r\n  [defaultActivities.CASTERCS]: defenses.REF,\r\n  [defaultActivities.CASTERSA]: defenses.AC,\r\n  [defaultActivities.CASTERS]: defenses.REF,\r\n  [defaultActivities.CASTERBR]: defenses.REF,\r\n};\r\n\r\nexport const defaultDamageConditions = {\r\n  [defaultActivities.FIGHTER]: dCond.STRIKE,\r\n  [defaultActivities.MARTIAL]: dCond.STRIKE,\r\n  [defaultActivities.CASTER]: dCond.STRIKE,\r\n  [defaultActivities.ALCH]: dCond.STRIKE,\r\n  [defaultActivities.FIGHTERR]: dCond.STRIKE,\r\n  [defaultActivities.MARTIALR]: dCond.STRIKE,\r\n  [defaultActivities.CASTERR]: dCond.STRIKE,\r\n  [defaultActivities.ALCHR]: dCond.STRIKE,\r\n  [defaultActivities.CASTERC]: dCond.STRIKE,\r\n  [defaultActivities.CASTERS]: dCond.BASIC,\r\n  [defaultActivities.CASTERCA]: dCond.STRIKE,\r\n  [defaultActivities.CASTERCS]: dCond.BASIC,\r\n  [defaultActivities.CASTERSA]: dCond.STRIKE,\r\n  [defaultActivities.CASTERS]: dCond.BASIC,\r\n  [defaultActivities.CASTERBR]: dCond.BASIC,\r\n};\r\n\r\nconst zero = {};\r\n\r\nconst maxScore = {};\r\nconst score16 = {};\r\nconst martialProf = {};\r\nconst alchProf = {};\r\nconst casterProf = {};\r\n\r\nconst spellProf = {};\r\n\r\nconst weaponItem = {};\r\nconst weaponDice = {};\r\nconst spellDice = {};\r\nconst spellDice2 = {};\r\nfor (let i = 1; i <= 20; i++) {\r\n  spellDice[i] = Math.floor((i + 1) / 2);\r\n  spellDice2[i] = 2 * Math.floor((i + 1) / 2);\r\n}\r\n\r\nconst martialSpec = {};\r\nconst casterSpec = {};\r\n\r\nconst fighterAB = {};\r\nconst martialAB = {};\r\nconst casterAB = {};\r\nconst alchAB = {};\r\n\r\nconst casterSpellAttack = {};\r\nconst casterSaveDC = {};\r\n\r\nconst fighterStatic = {};\r\nconst fighterRanged = {};\r\nconst martialStatic = {};\r\nconst martialRanged = {};\r\nconst casterStatic = {};\r\nconst casterRanged = {};\r\n\r\nfor (let i = 1; i <= 20; i++) {\r\n  zero[i] = 0;\r\n\r\n  maxScore[i] = 4;\r\n  score16[i] = 3;\r\n\r\n  martialProf[i] = 2;\r\n  alchProf[i] = 2;\r\n  casterProf[i] = 2;\r\n\r\n  spellProf[i] = 2;\r\n\r\n  weaponItem[i] = 0;\r\n  weaponDice[i] = 1;\r\n\r\n  martialSpec[i] = 0;\r\n  casterSpec[i] = 0;\r\n\r\n  if (i >= 2) {\r\n    weaponItem[i] = 1;\r\n  }\r\n  if (i >= 4) {\r\n    weaponDice[i] = 2;\r\n  }\r\n  if (i >= 5) {\r\n    martialProf[i] = 4;\r\n    score16[i] = 4;\r\n  }\r\n  if (i >= 7) {\r\n    alchProf[i] = 4;\r\n    martialSpec[i] = 1;\r\n    spellProf[i] = 4;\r\n  }\r\n  if (i >= 10) {\r\n    weaponItem[i] = 2;\r\n    maxScore[i] = 5;\r\n  }\r\n  if (i >= 11) {\r\n    casterProf[i] = 4;\r\n  }\r\n  if (i >= 12) {\r\n    weaponDice[i] = 3;\r\n  }\r\n  if (i >= 13) {\r\n    martialProf[i] = 6;\r\n    casterSpec[i] = 1;\r\n  }\r\n  if (i >= 15) {\r\n    martialSpec[i] = 2;\r\n    score16[i] = 5;\r\n    spellProf[i] = 6;\r\n  }\r\n  if (i >= 16) {\r\n    weaponItem[i] = 3;\r\n  }\r\n  if (i >= 17) {\r\n    maxScore[i] = 6;\r\n  }\r\n  if (i >= 19) {\r\n    weaponDice[i] = 4;\r\n    spellProf[i] = 8;\r\n  }\r\n  if (i >= 20) {\r\n    maxScore[i] = 7;\r\n  }\r\n\r\n  fighterAB[i] = i + martialProf[i] + maxScore[i] + weaponItem[i] + 2;\r\n  martialAB[i] = i + martialProf[i] + maxScore[i] + weaponItem[i];\r\n  casterAB[i] = i + casterProf[i] + score16[i] + weaponItem[i];\r\n  alchAB[i] = i + alchProf[i] + score16[i] + weaponItem[i];\r\n  casterSpellAttack[i] = i + spellProf[i] + maxScore[i];\r\n  casterSaveDC[i] = 10 + i + spellProf[i] + maxScore[i];\r\n\r\n  fighterStatic[i] = maxScore[i] + (martialSpec[i] * (martialProf[i] + 2)) / 2;\r\n  fighterRanged[i] = (martialSpec[i] * (martialProf[i] + 2)) / 2;\r\n  martialStatic[i] = maxScore[i] + (martialSpec[i] * martialProf[i]) / 2;\r\n  martialRanged[i] = (martialSpec[i] * martialProf[i]) / 2;\r\n  casterStatic[i] = score16[i] + (casterSpec[i] * casterProf[i]) / 2;\r\n  casterRanged[i] = (casterSpec[i] * casterProf[i]) / 2;\r\n}\r\n\r\nexport const defaultValues = {\r\n  [defaultActivities.FIGHTER]: fighterAB,\r\n  [defaultActivities.MARTIAL]: martialAB,\r\n  [defaultActivities.CASTER]: casterAB,\r\n  [defaultActivities.ALCH]: alchAB,\r\n  [defaultActivities.FIGHTERR]: fighterAB,\r\n  [defaultActivities.MARTIALR]: martialAB,\r\n  [defaultActivities.CASTERR]: casterAB,\r\n  [defaultActivities.ALCHR]: alchAB,\r\n  [defaultActivities.CASTERCA]: casterSpellAttack,\r\n  [defaultActivities.CASTERCS]: casterSaveDC,\r\n  [defaultActivities.CASTERSA]: casterSpellAttack,\r\n  [defaultActivities.CASTERS]: casterSaveDC,\r\n  [defaultActivities.CASTERBR]: casterSaveDC,\r\n};\r\n\r\nexport const defaultDiceNum = {\r\n  [defaultActivities.FIGHTER]: weaponDice,\r\n  [defaultActivities.MARTIAL]: weaponDice,\r\n  [defaultActivities.CASTER]: weaponDice,\r\n  [defaultActivities.ALCH]: weaponDice,\r\n  [defaultActivities.FIGHTERR]: weaponDice,\r\n  [defaultActivities.MARTIALR]: weaponDice,\r\n  [defaultActivities.CASTERR]: weaponDice,\r\n  [defaultActivities.ALCHR]: weaponDice,\r\n  [defaultActivities.CASTERCA]: spellDice,\r\n  [defaultActivities.CASTERCS]: spellDice,\r\n  [defaultActivities.CASTERSA]: zero,\r\n  [defaultActivities.CASTERS]: zero,\r\n  [defaultActivities.CASTERBR]: spellDice2,\r\n};\r\n\r\nexport const defaultStatic = {\r\n  [defaultActivities.FIGHTER]: fighterStatic,\r\n  [defaultActivities.MARTIAL]: martialStatic,\r\n  [defaultActivities.CASTER]: casterStatic,\r\n  [defaultActivities.ALCH]: casterStatic,\r\n  [defaultActivities.FIGHTERR]: fighterRanged,\r\n  [defaultActivities.MARTIALR]: martialRanged,\r\n  [defaultActivities.CASTERR]: casterRanged,\r\n  [defaultActivities.ALCHR]: casterRanged,\r\n  [defaultActivities.CASTERCA]: maxScore,\r\n  [defaultActivities.CASTERCS]: maxScore,\r\n  [defaultActivities.CASTERSA]: zero,\r\n  [defaultActivities.CASTERS]: zero,\r\n  [defaultActivities.CASTERBR]: zero,\r\n};\r\n\r\nconst extremeAC = {\r\n  \"-1\": 18,\r\n  0: 19,\r\n  1: 19,\r\n  2: 21,\r\n  3: 22,\r\n  4: 24,\r\n  5: 25,\r\n  6: 27,\r\n  7: 28,\r\n  8: 30,\r\n  9: 31,\r\n  10: 33,\r\n  11: 34,\r\n  12: 36,\r\n  13: 37,\r\n  14: 39,\r\n  15: 40,\r\n  16: 42,\r\n  17: 43,\r\n  18: 45,\r\n  19: 46,\r\n  20: 48,\r\n  21: 49,\r\n  22: 51,\r\n  23: 52,\r\n  24: 54,\r\n};\r\nconst highAC = { ...extremeAC };\r\nfor (let level in highAC) highAC[level] -= 3;\r\n\r\nconst moderateAC = { ...extremeAC };\r\nfor (let level in moderateAC) moderateAC[level] -= 4;\r\n\r\nconst lowAC = { ...extremeAC };\r\nfor (let level in lowAC) lowAC[level] -= 6;\r\n\r\nexport const defaultACs = {\r\n  [defaultValuesAC.EXTREME]: extremeAC,\r\n  [defaultValuesAC.HIGH]: highAC,\r\n  [defaultValuesAC.MODERATE]: moderateAC,\r\n  [defaultValuesAC.LOW]: lowAC,\r\n};\r\n\r\nconst extremeSaves = {\r\n  \"-1\": 9,\r\n  0: 10,\r\n  1: 11,\r\n  2: 12,\r\n  3: 14,\r\n  4: 15,\r\n  5: 17,\r\n  6: 18,\r\n  7: 20,\r\n  8: 21,\r\n  9: 23,\r\n  10: 24,\r\n  11: 26,\r\n  12: 27,\r\n  13: 29,\r\n  14: 30,\r\n  15: 32,\r\n  16: 33,\r\n  17: 35,\r\n  18: 36,\r\n  19: 38,\r\n  20: 39,\r\n  21: 41,\r\n  22: 43,\r\n  23: 44,\r\n  24: 46,\r\n};\r\nconst highSaves = {\r\n  \"-1\": 8,\r\n  0: 9,\r\n  1: 10,\r\n  2: 11,\r\n  3: 12,\r\n  4: 14,\r\n  5: 15,\r\n  6: 17,\r\n  7: 18,\r\n  8: 19,\r\n  9: 21,\r\n  10: 22,\r\n  11: 24,\r\n  12: 25,\r\n  13: 26,\r\n  14: 28,\r\n  15: 29,\r\n  16: 30,\r\n  17: 32,\r\n  18: 33,\r\n  19: 35,\r\n  20: 36,\r\n  21: 38,\r\n  22: 39,\r\n  23: 40,\r\n  24: 42,\r\n};\r\nconst moderateSaves = {\r\n  \"-1\": 5,\r\n  0: 6,\r\n  1: 7,\r\n  2: 8,\r\n  3: 9,\r\n  4: 11,\r\n  5: 12,\r\n  6: 14,\r\n  7: 15,\r\n  8: 16,\r\n  9: 18,\r\n  10: 19,\r\n  11: 21,\r\n  12: 22,\r\n  13: 23,\r\n  14: 25,\r\n  15: 26,\r\n  16: 28,\r\n  17: 29,\r\n  18: 30,\r\n  19: 32,\r\n  20: 33,\r\n  21: 35,\r\n  22: 36,\r\n  23: 37,\r\n  24: 38,\r\n};\r\nconst lowSaves = {\r\n  \"-1\": 2,\r\n  0: 3,\r\n  1: 4,\r\n  2: 5,\r\n  3: 6,\r\n  4: 8,\r\n  5: 9,\r\n  6: 11,\r\n  7: 12,\r\n  8: 13,\r\n  9: 15,\r\n  10: 16,\r\n  11: 18,\r\n  12: 19,\r\n  13: 20,\r\n  14: 22,\r\n  15: 23,\r\n  16: 25,\r\n  17: 26,\r\n  18: 27,\r\n  19: 29,\r\n  20: 30,\r\n  21: 32,\r\n  22: 33,\r\n  23: 34,\r\n  24: 36,\r\n};\r\nconst terribleSaves = {\r\n  \"-1\": 0,\r\n  0: 1,\r\n  1: 2,\r\n  2: 3,\r\n  3: 4,\r\n  4: 6,\r\n  5: 7,\r\n  6: 8,\r\n  7: 10,\r\n  8: 11,\r\n  9: 12,\r\n  10: 14,\r\n  11: 15,\r\n  12: 16,\r\n  13: 18,\r\n  14: 19,\r\n  15: 20,\r\n  16: 22,\r\n  17: 23,\r\n  18: 24,\r\n  19: 26,\r\n  20: 27,\r\n  21: 28,\r\n  22: 30,\r\n  23: 31,\r\n  24: 32,\r\n};\r\nexport const defaultSaves = {\r\n  [defaultValuesSaves.EXTREME]: extremeSaves,\r\n  [defaultValuesSaves.HIGH]: highSaves,\r\n  [defaultValuesSaves.MODERATE]: moderateSaves,\r\n  [defaultValuesSaves.LOW]: lowSaves,\r\n  [defaultValuesSaves.TERRIBLE]: terribleSaves,\r\n};\r\n","export const graphTypes = {\r\n  DISTRIBUTION: \"Damage Distribution\",\r\n  PMDEFENSE: \"+/- AC/Save Bonus\",\r\n  BYLEVEL: \"By Level\",\r\n};\r\n\r\nexport const activityTypes = {\r\n  STRIKE: \"Strike\",\r\n  SAVE: \"Save\",\r\n};\r\n\r\nexport const defaultActivities = {\r\n  FIGHTER: \"Fighter Melee\",\r\n  MARTIAL: \"Martial Melee\",\r\n  CASTER: \"Caster(16str) Melee\",\r\n  ALCH: \"Alchemist(16str) Melee\",\r\n  FIGHTERR: \"Fighter Ranged\",\r\n  MARTIALR: \"Martial Ranged\",\r\n  CASTERR: \"Caster(16dex) Ranged\",\r\n  ALCHR: \"Alchemist(16dex) Ranged\",\r\n  CASTERCA: \"Caster Cantrip Attack\",\r\n  CASTERCS: \"Caster Cantrip Save\",\r\n  CASTERBR: \"Caster 2dX Basic Save\",\r\n  CASTERSA: \"Caster Spell Attack\",\r\n  CASTERS: \"Caster Save\",\r\n};\r\n\r\nexport const defaultValuesAC = {\r\n  LOW: \"Low\",\r\n  MODERATE: \"Moderate\",\r\n  HIGH: \"High\",\r\n  EXTREME: \"Extreme\",\r\n};\r\n\r\nexport const defaultValuesSaves = {\r\n  TERRIBLE: \"Terrible\",\r\n  LOW: \"Low\",\r\n  MODERATE: \"Moderate\",\r\n  HIGH: \"High\",\r\n  EXTREME: \"Extreme\",\r\n};\r\n\r\nexport const defenses = {\r\n  AC: \"AC\",\r\n  FORT: \"Fort\",\r\n  REF: \"Ref\",\r\n  WILL: \"Will\",\r\n  PER: \"Perception\",\r\n};\r\n\r\nexport const MAPs = {\r\n  N1: \"0 (0x-5)\",\r\n  N2: \"-5 (1x-5)\",\r\n  N3: \"-10 (2x-5)\",\r\n  A1: \"0 (0x-4)\",\r\n  A2: \"-4 (1x-4)\",\r\n  A3: \"-8 (2x-4)\",\r\n  R1: \"0 (0x-3)\",\r\n  R2: \"-3 (1x-3)\",\r\n  R3: \"-6 (2x-3)\",\r\n  RA1: \"0 (0x-2)\",\r\n  RA2: \"-2 (1x-2)\",\r\n  RA3: \"-4 (2x-2)\",\r\n  RAA1: \"0 (0x-1)\",\r\n  RAA2: \"-1 (1x-1)\",\r\n  RAA3: \"-2 (2x-1)\",\r\n};\r\n\r\nexport const nextMAPs = {\r\n  \"0 (0x-5)\": \"-5 (1x-5)\",\r\n  \"-5 (1x-5)\": \"-10 (2x-5)\",\r\n  \"-10 (2x-5)\": \"-10 (2x-5)\",\r\n  \"0 (0x-4)\": \"-4 (1x-4)\",\r\n  \"-4 (1x-4)\": \"-8 (2x-4)\",\r\n  \"-8 (2x-4)\": \"-8 (2x-4)\",\r\n  \"0 (0x-3)\": \"-3 (1x-3)\",\r\n  \"-3 (1x-3)\": \"-6 (2x-3)\",\r\n  \"-6 (2x-3)\": \"-6 (2x-3)\",\r\n  \"0 (0x-2)\": \"-2 (1x-2)\",\r\n  \"-2 (1x-2)\": \"-4 (2x-2)\",\r\n  \"-4 (2x-2)\": \"-4 (2x-2)\",\r\n  \"0 (0x-1)\": \"-1 (1x-1)\",\r\n  \"-1 (1x-1)\": \"-2 (2x-1)\",\r\n  \"-2 (2x-1)\": \"-2 (2x-1)\",\r\n};\r\n\r\nexport const MAPvalues = {\r\n  \"0 (0x-5)\": 0,\r\n  \"-5 (1x-5)\": -5,\r\n  \"-10 (2x-5)\": -10,\r\n  \"0 (0x-4)\": 0,\r\n  \"-4 (1x-4)\": -4,\r\n  \"-8 (2x-4)\": -8,\r\n  \"0 (0x-3)\": 0,\r\n  \"-3 (1x-3)\": -3,\r\n  \"-6 (2x-3)\": -6,\r\n  \"0 (0x-2)\": 0,\r\n  \"-2 (1x-2)\": -2,\r\n  \"-4 (2x-2)\": -4,\r\n  \"0 (0x-1)\": 0,\r\n  \"-1 (1x-1)\": -1,\r\n  \"-2 (2x-1)\": -2,\r\n};\r\n\r\nexport const rollTypes = {\r\n  NORMAL: \"Normal\",\r\n  ADVANTAGE: \"Advantage\",\r\n  DISADVANTAGE: \"Disadvantage\",\r\n};\r\n\r\nexport const damageTypes = {\r\n  NONE: \"None\",\r\n  B: \"bludgeoning\",\r\n  P: \"piercing\",\r\n  S: \"slashing\",\r\n  FIRE: \"fire\",\r\n};\r\n\r\nexport const materials = {\r\n  NONE: \"none\",\r\n  COLD_IRON: \"cold iron\",\r\n  SILVER: \"silver\",\r\n  ADAMANTINE: \"adamantine\",\r\n};\r\n\r\nexport const conditions = {\r\n  ALWAYS: \"Always\",\r\n  CRIT: \"On Crit\",\r\n  SUCC: \"On Success\",\r\n  FAIL: \"On Failure\",\r\n  CRIF: \"On Crit Fail\",\r\n  AT_LEAST_SUCC: \"Success or better\",\r\n  AT_LEAST_FAIL: \"Failure or better\",\r\n  FAIL_WORSE: \"Failure or worse\",\r\n  SUCC_WORSE: \"Success or worse\",\r\n};\r\n\r\nexport const dCond = {\r\n  STRIKE: \"x1 hit, x2 crit\",\r\n  BASIC: \"Basic save\",\r\n  ALWAYS: \"Always\",\r\n  CRIT: \"On Crit\",\r\n  SUCC: \"On Success\",\r\n  FAIL: \"On Failure\",\r\n  CRIF: \"On Crit Fail\",\r\n  AT_LEAST_SUCC: \"Success or better\",\r\n  AT_LEAST_FAIL: \"Failure or better\",\r\n  FAIL_WORSE: \"Failure or worse\",\r\n  SUCC_WORSE: \"Success or worse\",\r\n};\r\n\r\nexport const diceNums = {\r\n  0: 0,\r\n  1: 1,\r\n  2: 2,\r\n  3: 3,\r\n  4: 4,\r\n  5: 5,\r\n  6: 6,\r\n  7: 7,\r\n  8: 8,\r\n  9: 9,\r\n  10: 10,\r\n  11: 11,\r\n  12: 12,\r\n  13: 13,\r\n  14: 14,\r\n  15: 15,\r\n  16: 16,\r\n  17: 17,\r\n  18: 18,\r\n  19: 19,\r\n  20: 20,\r\n};\r\n\r\nexport const diceSizes = {\r\n  4: 4,\r\n  6: 6,\r\n  8: 8,\r\n  10: 10,\r\n  12: 12,\r\n};\r\n","import { createEntityAdapter, createSlice } from \"@reduxjs/toolkit\";\r\n\r\nexport const weaknessAdapter = createEntityAdapter();\r\n\r\nlet weakness = 0;\r\n\r\nexport const weaknessesSlice = createSlice({\r\n  name: \"weaknesses\",\r\n  initialState: weaknessAdapter.getInitialState(),\r\n  reducers: {\r\n    weaknessAdded: weaknessAdapter.addOne,\r\n    weaknessUpdated: weaknessAdapter.updateOne,\r\n    weaknessCreated: {\r\n      reducer: (state, action) => {\r\n        const { id, type, value } = action.payload;\r\n        weaknessAdapter.addOne(state, { id, type, value });\r\n      },\r\n      prepare: ({ parentId, type, value }) => {\r\n        const id = ++weakness;\r\n        return {\r\n          payload: {\r\n            id,\r\n            parentId,\r\n            type,\r\n            value,\r\n          },\r\n        };\r\n      },\r\n    },\r\n    weaknessRemoved: weaknessAdapter.removeOne,\r\n  },\r\n});\r\n\r\nexport const {\r\n  weaknessRemoved,\r\n  weaknessCreated,\r\n  weaknessAdded,\r\n  weaknessUpdated,\r\n} = weaknessesSlice.actions;\r\n\r\nexport default weaknessesSlice.reducer;\r\n\r\nexport const {\r\n  selectById: selectweaknessById,\r\n  selectIds: selectweaknessIds,\r\n  selectEntities: selectweaknessEntities,\r\n  selectAll: selectAllweaknesses,\r\n  selectTotal: selectTotalweaknesses,\r\n} = weaknessAdapter.getSelectors((state) => state.weaknesses);\r\n","import { createEntityAdapter, createSlice } from \"@reduxjs/toolkit\";\r\nimport { defaultACs, defaultSaves } from \"../defaults\";\r\nimport { defenses } from \"../types\";\r\nimport { weaknessCreated, weaknessRemoved } from \"./weaknessSlice\";\r\n\r\nexport const targetAdapter = createEntityAdapter();\r\n\r\nexport const targetsSlice = createSlice({\r\n  name: \"targets\",\r\n  initialState: targetAdapter.getInitialState(),\r\n  reducers: {\r\n    targetAdded: targetAdapter.addOne,\r\n    targetUpdated: {\r\n      prepare: ({ id, changes, match, level }) => {\r\n        if (!level) level = 1;\r\n        if (level < 1) level = 1;\r\n        if (level > 20) level = 20;\r\n        return { payload: { id, changes, match, level } };\r\n      },\r\n      reducer: (state, action) => {\r\n        targetAdapter.updateOne(state, action.payload);\r\n        const target = state.entities[action.payload.id];\r\n        if (!target.level) target.level = 0;\r\n        if (target.level < -1) target.level = -1;\r\n        if (target.level > 24) target.level = 24;\r\n        if (target.useDefaultAC) {\r\n          target[defenses.AC] = defaultACs[target.defaultAC][target.level];\r\n        }\r\n        if (target.useDefaultFort) {\r\n          target[defenses.FORT] =\r\n            defaultSaves[target.defaultFort][target.level];\r\n        }\r\n        if (target.useDefaultRef) {\r\n          target[defenses.REF] = defaultSaves[target.defaultRef][target.level];\r\n        }\r\n        if (target.useDefaultWill) {\r\n          target[defenses.WILL] =\r\n            defaultSaves[target.defaultWill][target.level];\r\n        }\r\n        if (target.useDefaultPer) {\r\n          target[defenses.PER] = defaultSaves[target.defaultPer][target.level];\r\n        }\r\n      },\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(weaknessCreated, (state, action) => {\r\n        const { parentId: id, id: weaknessId } = action.payload;\r\n        state.entities[id].weaknesses.push(weaknessId);\r\n        // targetAdded.updateOne(state, { id, changes: { weaknesses: [...weaknesses, weaknessId] }});\r\n      })\r\n      .addCase(weaknessRemoved, (state, action) => {\r\n        const { parentId: id, id: weaknessId } = action.payload;\r\n        state.entities[id].weaknesses = state.entities[id].weaknesses.filter(\r\n          (wid) => wid !== weaknessId\r\n        );\r\n      });\r\n  },\r\n});\r\n\r\nexport const { targetAdded, targetUpdated } = targetsSlice.actions;\r\n\r\nexport default targetsSlice.reducer;\r\n\r\nexport const {\r\n  selectById: selecttargetById,\r\n  selectIds: selecttargetIds,\r\n  selectEntities: selecttargetEntities,\r\n  selectAll: selectAlltargets,\r\n  selectTotal: selectTotaltargets,\r\n} = targetAdapter.getSelectors((state) => state.targets);\r\n","import React, { useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { selecttargetById, targetUpdated } from \"./targetSlice\";\r\nimport {\r\n  damageTypes,\r\n  defaultValuesAC,\r\n  defaultValuesSaves,\r\n  defenses,\r\n  materials,\r\n} from \"../types\";\r\nimport {\r\n  selectweaknessById,\r\n  weaknessCreated,\r\n  weaknessRemoved,\r\n  weaknessUpdated,\r\n} from \"./weaknessSlice\";\r\n\r\nfunction TargetInput({ id }) {\r\n  const {\r\n    name,\r\n    level,\r\n    matchRoutines,\r\n    levelDiff,\r\n    [defenses.AC]: AC,\r\n    defaultAC,\r\n    useDefaultAC,\r\n    [defenses.FORT]: Fort,\r\n    defaultFort,\r\n    useDefaultFort,\r\n    [defenses.REF]: Ref,\r\n    defaultRef,\r\n    useDefaultRef,\r\n    [defenses.WILL]: Will,\r\n    defaultWill,\r\n    useDefaultWill,\r\n    [defenses.PER]: Perception,\r\n    defaultPer,\r\n    useDefaultPer,\r\n    flatfooted,\r\n    weaknesses,\r\n  } = useSelector((state) => selecttargetById(state, 0));\r\n  const dispatch = useDispatch();\r\n\r\n  const ACOptions = [];\r\n  for (let dv in defaultValuesAC) {\r\n    ACOptions.push(<option key={dv}>{defaultValuesAC[dv]}</option>);\r\n  }\r\n  const SaveOptions = [];\r\n  for (let dv in defaultValuesSaves) {\r\n    SaveOptions.push(<option key={dv}>{defaultValuesSaves[dv]}</option>);\r\n  }\r\n\r\n  // name, level, ac, fort, ref, will, perception, resistances/weaknesses\r\n  return (\r\n    <div className=\"box flexbox\">\r\n      <span className=\"input\">\r\n        <label htmlFor=\"targetName\">{\"Target Name: \"}</label>\r\n        <input\r\n          id=\"targetName\"\r\n          type=\"text\"\r\n          placeholder=\"Enter Target name\"\r\n          value={name}\r\n          onChange={(e) =>\r\n            dispatch(targetUpdated({ id, changes: { name: e.target.value } }))\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"Level\">{\" Level: \"}</label>\r\n        <input\r\n          id=\"Level\"\r\n          type=\"number\"\r\n          value={level}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: {\r\n                  level: parseInt(e.target.value),\r\n                },\r\n                match: matchRoutines,\r\n                level: parseInt(e.target.value) - levelDiff,\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"match\">{\" Match routine levels: \"}</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={matchRoutines}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { matchRoutines: e.target.checked },\r\n                match: e.target.checked,\r\n                level: level - levelDiff,\r\n              })\r\n            )\r\n          }\r\n        />\r\n        <input\r\n          type=\"number\"\r\n          value={levelDiff}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: {\r\n                  levelDiff: parseInt(e.target.value),\r\n                },\r\n                match: matchRoutines,\r\n                level: level - parseInt(e.target.value),\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"AC\">{\" AC: \"}</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={useDefaultAC}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { useDefaultAC: e.target.checked } })\r\n            )\r\n          }\r\n        />\r\n        <select\r\n          value={defaultAC}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { defaultAC: e.target.value } })\r\n            )\r\n          }\r\n        >\r\n          {ACOptions}\r\n        </select>\r\n        <input\r\n          id=\"AC\"\r\n          type=\"number\"\r\n          value={AC}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: {\r\n                  useDefaultAC: false,\r\n                  [defenses.AC]: parseInt(e.target.value),\r\n                },\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"Fort\">{\" Fort: \"}</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={useDefaultFort}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { useDefaultFort: e.target.checked },\r\n              })\r\n            )\r\n          }\r\n        />\r\n        <select\r\n          value={defaultFort}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { defaultFort: e.target.value } })\r\n            )\r\n          }\r\n        >\r\n          {SaveOptions}\r\n        </select>\r\n        <input\r\n          id=\"Fort\"\r\n          type=\"number\"\r\n          value={Fort}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { [defenses.FORT]: parseInt(e.target.value) },\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"Ref\">{\" Ref: \"}</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={useDefaultRef}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { useDefaultRef: e.target.checked },\r\n              })\r\n            )\r\n          }\r\n        />\r\n        <select\r\n          value={defaultRef}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { defaultRef: e.target.value } })\r\n            )\r\n          }\r\n        >\r\n          {SaveOptions}\r\n        </select>\r\n        <input\r\n          id=\"Ref\"\r\n          type=\"number\"\r\n          value={Ref}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { [defenses.REF]: parseInt(e.target.value) },\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"Will\">{\" Will: \"}</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={useDefaultWill}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { useDefaultWill: e.target.checked },\r\n              })\r\n            )\r\n          }\r\n        />\r\n        <select\r\n          value={defaultWill}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { defaultWill: e.target.value } })\r\n            )\r\n          }\r\n        >\r\n          {SaveOptions}\r\n        </select>\r\n        <input\r\n          id=\"Will\"\r\n          type=\"number\"\r\n          value={Will}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { [defenses.WILL]: parseInt(e.target.value) },\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"Perception\">{\" Perception: \"}</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={useDefaultPer}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { useDefaultPer: e.target.checked },\r\n              })\r\n            )\r\n          }\r\n        />\r\n        <select\r\n          value={defaultPer}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { defaultPer: e.target.value } })\r\n            )\r\n          }\r\n        >\r\n          {SaveOptions}\r\n        </select>\r\n        <input\r\n          id=\"Perception\"\r\n          type=\"number\"\r\n          value={Perception}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({\r\n                id,\r\n                changes: { [defenses.PER]: parseInt(e.target.value) },\r\n              })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <span className=\"input\">\r\n        <label htmlFor=\"Flatfooted\">{\" Flatfooted: \"}</label>\r\n        <input\r\n          id=\"Flatfooted\"\r\n          type=\"checkbox\"\r\n          checked={flatfooted}\r\n          onChange={(e) =>\r\n            dispatch(\r\n              targetUpdated({ id, changes: { flatfooted: e.target.checked } })\r\n            )\r\n          }\r\n        />\r\n      </span>\r\n\r\n      <div className=\"box flexbox\">\r\n        {\" Resistance/Weakness: \"}\r\n        {weaknesses.map((weaknessId) => (\r\n          <Weakness parentId={id} id={weaknessId} key={weaknessId} />\r\n        ))}\r\n        <AddWeakness parentId={id} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// const TargetInfo = ({ id }) => {\r\n//   const { overrideDefault, type, value, weaknesses } = useSelector((state) =>\r\n//     selecttargetInfoById(state, id)\r\n//   );\r\n//   const dispatch = useDispatch();\r\n\r\n//   const defenseOptions = [];\r\n//   for (let d in defenses) {\r\n//     defenseOptions.push(<option key={d}>{defenses[d]}</option>);\r\n//   }\r\n\r\n//   return (\r\n//     <div className=\"box\">\r\n//       {\"Override Target: \"}\r\n//       <input\r\n//         type=\"checkbox\"\r\n//         checked={overrideDefault}\r\n//         onChange={(e) =>\r\n//           dispatch(\r\n//             targetInfoUpdated({\r\n//               id,\r\n//               changes: { overrideDefault: e.target.checked },\r\n//             })\r\n//           )\r\n//         }\r\n//       />\r\n\r\n// {/* <Weaknesses parentId={id} weaknessIds={weaknesses} /> */}\r\n\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// const Weaknesses = ({ parentId, weaknessIds }) => {\r\n//   return (\r\n//     <span>\r\n//       {weaknessIds.map((weaknessId) => (\r\n//         <Weakness id={weaknessId} key={weaknessId} />\r\n//       ))}\r\n//       <AddWeakness id={parentId} />\r\n//     </span>\r\n//   );\r\n// };\r\n\r\nconst Weakness = ({ id, parentId }) => {\r\n  // needs to have parent id to remove weakness\r\n  const { type, value } = useSelector((state) => selectweaknessById(state, id));\r\n  const dispatch = useDispatch();\r\n\r\n  const updateOrRemoveWeakness = (e) => {\r\n    if (e.target.value === damageTypes.NONE) {\r\n      // remove this weakness\r\n      dispatch(weaknessRemoved({ id, parentId }));\r\n    } else {\r\n      dispatch(weaknessUpdated({ id, changes: { type: e.target.value } }));\r\n    }\r\n  };\r\n  const updateWeaknessValue = (e) => {\r\n    if (!isNaN(e.target.value)) {\r\n      dispatch(\r\n        weaknessUpdated({ id, changes: { value: parseInt(e.target.value) } })\r\n      );\r\n    }\r\n  };\r\n  return (\r\n    <span className=\"input\">\r\n      <WeaknessSelect value={type} onChange={updateOrRemoveWeakness} />\r\n      <input type=\"number\" value={value} onChange={updateWeaknessValue} />\r\n    </span>\r\n  );\r\n};\r\n\r\nlet weaknessId = 0;\r\n\r\nconst AddWeakness = ({ parentId }) => {\r\n  const dispatch = useDispatch();\r\n  let [weaknessValue, setWeaknessValue] = useState(0);\r\n\r\n  // add a Weakness to TargetInfo id\r\n  const addWeakness = (e) => {\r\n    if (e.target.value !== damageTypes.NONE) {\r\n      // need to create a new weakness\r\n      weaknessId++;\r\n      dispatch(\r\n        weaknessCreated({\r\n          id: weaknessId,\r\n          type: e.target.value,\r\n          value: weaknessValue,\r\n          parentId: parentId,\r\n        })\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <span className=\"input\">\r\n      <WeaknessSelect value={damageTypes.NONE} onChange={addWeakness} />\r\n      <input\r\n        type=\"number\"\r\n        value={weaknessValue}\r\n        onChange={(e) => setWeaknessValue(parseInt(e.target.value))}\r\n      />\r\n    </span>\r\n  );\r\n};\r\n\r\nconst WeaknessSelect = ({ value, onChange }) => {\r\n  const options = [];\r\n  for (let dt in damageTypes) {\r\n    options.push(<option key={dt}>{damageTypes[dt]}</option>);\r\n  }\r\n  for (let m in materials) {\r\n    if (materials[m] === materials.NONE) continue;\r\n    options.push(<option key={m}>{materials[m]}</option>);\r\n  }\r\n  return (\r\n    <span>\r\n      <select value={value} onChange={(e) => onChange(e)}>\r\n        {options}\r\n      </select>\r\n    </span>\r\n  );\r\n};\r\n\r\nexport default TargetInput;\r\n","export const convolve = (vec1, vec2) => {\r\n  if (vec1.length === 0 || vec2.length === 0) {\r\n    throw new Error(\"Vectors can not be empty!\");\r\n  }\r\n  const volume = vec1;\r\n  const kernel = vec2;\r\n  let displacement = 0;\r\n  const convVec = [];\r\n\r\n  for (let i = 0; i < volume.length; i++) {\r\n    for (let j = 0; j < kernel.length; j++) {\r\n      if (displacement + j !== convVec.length) {\r\n        convVec[displacement + j] =\r\n          convVec[displacement + j] + volume[i] * kernel[j];\r\n      } else {\r\n        convVec.push(volume[i] * kernel[j]);\r\n      }\r\n    }\r\n    displacement++;\r\n  }\r\n\r\n  return convVec;\r\n};\r\n\r\nexport const multiplyDist = (dam, dist, multiplier) => {\r\n  if (multiplier === 0) return [0, [1]];\r\n  if (multiplier === 1) return [dam, dist];\r\n\r\n  const newDist = [0];\r\n  let index = 0;\r\n  const newDam = Math.floor(dam * multiplier);\r\n\r\n  let i = 0;\r\n  let oldValue = newDam;\r\n  for (let chance of dist) {\r\n    let newValue = Math.floor((dam + i) * multiplier);\r\n    if (newValue === oldValue) {\r\n      // console.log(`adding ${newValue} at ${index} with ${chance}`);\r\n      newDist[index] += chance;\r\n    } else {\r\n      if (newValue > oldValue + 1) {\r\n        for (let diff = 0; diff < newValue - (oldValue + 1); diff++) {\r\n          index++;\r\n          // console.log(`adding ${newValue} at ${index} with ${0}`);\r\n          newDist[index] = 0;\r\n        }\r\n      }\r\n      index++;\r\n      // console.log(`adding ${newValue} at ${index} with ${chance}`);\r\n      newDist[index] = chance;\r\n    }\r\n    oldValue = newValue;\r\n    i++;\r\n  }\r\n\r\n  return [newDam, newDist];\r\n};\r\n\r\nexport const consolidateDists = (...dists) => {\r\n  // dists = [[{staticDamage, damageDist}, chance]]...]\r\n  // console.log(dists);\r\n  let maxDamage = 0;\r\n  for (let dist of dists) {\r\n    // console.log(`chance is ${dist[1]}`);\r\n    maxDamage = Math.max(\r\n      maxDamage,\r\n      dist[0].staticDamage + dist[0].damageDist.length\r\n    );\r\n  }\r\n  let damageDist = [];\r\n  for (let i = 0; i < maxDamage; i++) {\r\n    damageDist.push(0);\r\n    // console.log(`i is ${i}`);\r\n    for (let dist of dists) {\r\n      if (dist[0].staticDamage <= i) {\r\n        let index = i - dist[0].staticDamage;\r\n        // console.log(`val ${dist[0].damageDist[index]} at index ${index}`);\r\n        if (index < dist[0].damageDist.length)\r\n          damageDist[i] += dist[0].damageDist[index] * dist[1];\r\n      }\r\n    }\r\n  }\r\n  // console.log([staticDamage, damageDist]);\r\n  return damageDist;\r\n};\r\n\r\nexport const applyMin = (staticDamage, damageDist, min) => {\r\n  // TODO: implement applyMin\r\n  while (staticDamage < min) {\r\n    if (damageDist.length >= 2) {\r\n      damageDist[1] += damageDist[0];\r\n      damageDist.shift();\r\n    }\r\n    staticDamage++;\r\n  }\r\n  return [staticDamage, damageDist];\r\n};\r\n","import { createEntityAdapter, createSlice } from \"@reduxjs/toolkit\";\r\nimport { damageTypes, dCond, materials } from \"../types\";\r\n\r\nexport const damageAdapter = createEntityAdapter();\r\n\r\n// damageAdded({\r\n//   id: 0,\r\n//   condition: dCond.STRIKE,\r\n//   diceNum: 1,\r\n//   diceSize: 8,\r\n//   staticDamage: 6,\r\n//   type: damageTypes.PIERCE,\r\n//   material: materials.COLD_IRON,\r\n// });\r\n\r\nlet damageId = 1;\r\nexport const damagesSlice = createSlice({\r\n  name: \"damages\",\r\n  initialState: damageAdapter.getInitialState(),\r\n  reducers: {\r\n    damageAdded: damageAdapter.addOne,\r\n    damageUpdated: damageAdapter.updateOne,\r\n    damageCreated: {\r\n      reducer: (state, action) => {\r\n        const {\r\n          id,\r\n          damageCondition,\r\n          diceNum,\r\n          diceSize,\r\n          staticDamage,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n        } = action.payload;\r\n        damageAdapter.addOne(state, {\r\n          id,\r\n          damageCondition,\r\n          diceNum,\r\n          diceSize,\r\n          staticDamage,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n        });\r\n      },\r\n      prepare: ({ parentId }) => {\r\n        const id = ++damageId;\r\n        return {\r\n          payload: {\r\n            id,\r\n            parentId,\r\n            damageCondition: dCond.STRIKE,\r\n            diceNum: 0,\r\n            diceSize: 8,\r\n            staticDamage: 0,\r\n            damageType: damageTypes.S,\r\n            material: materials.NONE,\r\n            persistent: false,\r\n          },\r\n        };\r\n      },\r\n    },\r\n    damageRemoved: (state, action) => {\r\n      damageAdapter.removeOne(state, action.payload.id);\r\n    },\r\n  },\r\n});\r\n\r\nexport const { damageRemoved, damageCreated, damageAdded, damageUpdated } =\r\n  damagesSlice.actions;\r\n\r\nexport default damagesSlice.reducer;\r\n\r\nexport const {\r\n  selectById: selectdamageById,\r\n  selectIds: selectdamageIds,\r\n  selectEntities: selectdamageEntities,\r\n  selectAll: selectAlldamages,\r\n  selectTotal: selectTotaldamages,\r\n} = damageAdapter.getSelectors((state) => state.damages);\r\n","import { createEntityAdapter, createSlice } from \"@reduxjs/toolkit\";\r\nimport {\r\n  defaultDamageConditions,\r\n  defaultDiceNum,\r\n  defaultStatic,\r\n  defaultTargetTypes,\r\n  defaultTypes,\r\n  defaultValues,\r\n} from \"../defaults\";\r\nimport { targetUpdated } from \"../Target/targetSlice\";\r\nimport {\r\n  activityTypes,\r\n  conditions,\r\n  damageTypes,\r\n  dCond,\r\n  defaultActivities,\r\n  defenses,\r\n  MAPs,\r\n  materials,\r\n  nextMAPs,\r\n} from \"../types\";\r\nimport { damageCreated, damageRemoved } from \"./damageSlice\";\r\n\r\nfunction setDefault(state, apId, setChildren = true) {\r\n  function applyDefault(apId) {\r\n    const ap = state.entities[apId];\r\n    if (ap.override) {\r\n      return;\r\n    }\r\n    const defaultActivity = ap.defaultActivity;\r\n    ap.type = defaultTypes[defaultActivity];\r\n    ap.targetType = defaultTargetTypes[defaultActivity];\r\n    ap.value = defaultValues[defaultActivity][ap.level];\r\n    ap.damageCondition = defaultDamageConditions[defaultActivity];\r\n    ap.diceNum = defaultDiceNum[defaultActivity][ap.level];\r\n    ap.staticDamage = defaultStatic[defaultActivity][ap.level];\r\n    if (setChildren) {\r\n      for (let apId of ap.apIds) {\r\n        state.entities[apId].level = ap.level;\r\n        applyDefault(apId);\r\n      }\r\n    }\r\n  }\r\n  applyDefault(apId);\r\n}\r\nexport const activityPathAdapter = createEntityAdapter();\r\n\r\nlet activityPathId = 1;\r\nconst defaultParentActivity = {\r\n  level: 1,\r\n  useDefault: false,\r\n  defaultActivity: defaultActivities.FIGHTER,\r\n  type: activityTypes.STRIKE,\r\n  targetType: defenses.AC,\r\n  value: 9,\r\n  MAP: MAPs.N1,\r\n  damageCondition: dCond.STRIKE,\r\n  diceNum: 1,\r\n  diceSize: 8,\r\n  staticDamage: 4,\r\n  damageType: damageTypes.S,\r\n  material: materials.NONE,\r\n};\r\n\r\nexport const activityPathsSlice = createSlice({\r\n  name: \"activityPaths\",\r\n  initialState: activityPathAdapter.getInitialState(),\r\n  reducers: {\r\n    activityPathAdded: activityPathAdapter.addOne,\r\n    activityPathUpdated: (state, action) => {\r\n      activityPathAdapter.updateOne(state, action.payload);\r\n      setDefault(state, action.payload.id);\r\n    },\r\n    activityPathRemoved: (state, action) => {\r\n      const { id, parentId } = action.payload;\r\n      activityPathAdapter.removeOne(state, id);\r\n      if (parentId !== undefined) {\r\n        state.entities[parentId].apIds = state.entities[parentId].apIds.filter(\r\n          (apId) => apId !== id\r\n        );\r\n      }\r\n    },\r\n    activityPathCreated: {\r\n      reducer: (state, action) => {\r\n        const { id, parentId, applyMAP } = action.payload;\r\n\r\n        let parentAP;\r\n        if (parentId !== undefined) {\r\n          parentAP = state.entities[parentId];\r\n        } else {\r\n          parentAP = defaultParentActivity;\r\n        }\r\n\r\n        activityPathAdapter.addOne(state, {\r\n          id,\r\n          condition: conditions.ALWAYS,\r\n          override: false,\r\n          level: parentAP.level,\r\n          useDefault: parentAP.useDefault,\r\n          defaultActivity: parentAP.defaultActivity,\r\n          type: parentAP.type,\r\n          targetType: parentAP.targetType,\r\n          targetInfoId: 0,\r\n          value: parentAP.value,\r\n          MAP: applyMAP ? nextMAPs[parentAP.MAP] : parentAP.MAP,\r\n          damageCondition: parentAP.damageCondition,\r\n          diceNum: parentAP.diceNum,\r\n          diceSize: parentAP.diceSize,\r\n          staticDamage: parentAP.staticDamage,\r\n          damageType: parentAP.damageType,\r\n          material: parentAP.material,\r\n          damages: [],\r\n          effects: [],\r\n          apIds: [],\r\n        });\r\n\r\n        if (parentId !== undefined) state.entities[parentId].apIds.push(id);\r\n      },\r\n      prepare: ({ parentId, routineId, applyMAP }) => {\r\n        const id = ++activityPathId;\r\n        return {\r\n          payload: {\r\n            id,\r\n            parentId,\r\n            routineId,\r\n            applyMAP,\r\n          },\r\n        };\r\n      },\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(damageCreated, (state, action) => {\r\n        const { parentId: id, id: damageId } = action.payload;\r\n        state.entities[id].damages.push(damageId);\r\n      })\r\n      .addCase(damageRemoved, (state, action) => {\r\n        const { parentId: id, id: damageId } = action.payload;\r\n        state.entities[id].damages = state.entities[id].damages.filter(\r\n          (did) => did !== damageId\r\n        );\r\n      })\r\n      .addCase(targetUpdated, (state, action) => {\r\n        const { match, level } = action.payload;\r\n        defaultParentActivity.level = level;\r\n        if (match) {\r\n          for (let id of state.ids) {\r\n            state.entities[id].level = level;\r\n            setDefault(state, id, false);\r\n          }\r\n        }\r\n      });\r\n  },\r\n});\r\n\r\nexport const {\r\n  activityPathCreated,\r\n  activityPathAdded,\r\n  activityPathUpdated,\r\n  activityPathRemoved,\r\n} = activityPathsSlice.actions;\r\n\r\nexport default activityPathsSlice.reducer;\r\n\r\nexport const {\r\n  selectById: selectactivityPathById,\r\n  selectIds: selectactivityPathIds,\r\n  selectEntities: selectactivityPathEntities,\r\n  selectAll: selectAllactivityPaths,\r\n  selectTotal: selectTotalactivityPaths,\r\n} = activityPathAdapter.getSelectors((state) => state.activityPaths);\r\n","import { createEntityAdapter, createSlice } from \"@reduxjs/toolkit\";\r\nimport { activityPathCreated, activityPathRemoved } from \"./activityPathSlice\";\r\n\r\nexport const routinesAdapter = createEntityAdapter();\r\n\r\nlet routineId = 1;\r\nexport const routinesSlice = createSlice({\r\n  name: \"routines\",\r\n  initialState: routinesAdapter.getInitialState({ selectedRoutine: 0 }),\r\n  reducers: {\r\n    setRoutine: (state, action) => {\r\n      state.selectedRoutine = action.payload || 0;\r\n    },\r\n    routineAdded: routinesAdapter.addOne,\r\n    routineUpdated: routinesAdapter.updateOne,\r\n    routineRemoved: (state, action) => {\r\n      routinesAdapter.removeOne(state, action);\r\n      if (action.payload === state.selectedRoutine)\r\n        state.selectedRoutine = state.ids ? state.ids[0] : undefined;\r\n    },\r\n    routineCreated: {\r\n      reducer: (state, action) => {\r\n        const { id, name, apIds } = action.payload;\r\n        state.selectedRoutine = id;\r\n        routinesAdapter.addOne(state, { id, name, display: true, apIds });\r\n      },\r\n      prepare: () => {\r\n        const id = ++routineId;\r\n        return { payload: { id, name: \"New Routine\", apIds: [] } };\r\n      },\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(activityPathCreated, (state, action) => {\r\n        const { routineId: id, id: apId } = action.payload;\r\n        if (id !== undefined) state.entities[id].apIds.push(apId);\r\n      })\r\n      .addCase(activityPathRemoved, (state, action) => {\r\n        const { routineId, id } = action.payload;\r\n        if (routineId !== undefined) {\r\n          state.entities[routineId].apIds = state.entities[\r\n            routineId\r\n          ].apIds.filter((apId) => apId !== id);\r\n        }\r\n      });\r\n  },\r\n});\r\n\r\nexport const {\r\n  routineCreated,\r\n  setRoutine,\r\n  updateSelected,\r\n  routineAdded,\r\n  routineUpdated,\r\n  routineRemoved,\r\n} = routinesSlice.actions;\r\n\r\nexport default routinesSlice.reducer;\r\n\r\nexport const {\r\n  selectById: selectRoutineById,\r\n  selectIds: selectRoutineIds,\r\n  selectEntities: selectRoutineEntities,\r\n  selectAll: selectAllRoutines,\r\n  selectTotal: selectTotalRoutines,\r\n} = routinesAdapter.getSelectors((state) => state.routines);\r\n\r\nexport const selectSelectedRoutine = (state) => state.routines.selectedRoutine;\r\n","import {\r\n  activityTypes,\r\n  dCond,\r\n  defenses,\r\n  MAPvalues,\r\n  materials,\r\n  rollTypes,\r\n} from \"../types\";\r\nimport { applyMin, convolve, multiplyDist } from \"./Distribution\";\r\n\r\nfunction getCritSuccessPercent(bonus, DC, keen = false) {\r\n  const dif = bonus - DC;\r\n  let chance;\r\n  if (dif < -20) {\r\n    chance = 0;\r\n  } else if (dif === -20) {\r\n    chance = 5;\r\n  } else if (dif < -9) {\r\n    chance = keen ? 10 : 5;\r\n  } else if (dif < 8) {\r\n    chance = (11 + dif) * 5;\r\n  } else {\r\n    chance = 95;\r\n  }\r\n\r\n  return chance;\r\n}\r\n\r\nfunction getSuccessPercent(bonus, DC, keen = false) {\r\n  const dif = bonus - DC;\r\n  let chance;\r\n  if (dif < -29) {\r\n    chance = 0;\r\n  } else if (dif < -20) {\r\n    chance = 5;\r\n  } else if (dif === -20) {\r\n    chance = 0;\r\n  } else if (dif < -9) {\r\n    chance = (keen ? 19 : 20 + dif) * 5;\r\n  } else if (dif < -1) {\r\n    chance = 50;\r\n  } else if (dif < 9) {\r\n    chance = (8 - dif) * 5;\r\n  } else {\r\n    chance = 5;\r\n  }\r\n\r\n  return chance;\r\n}\r\n\r\nfunction getFailurePercent(bonus, DC, keen = false) {\r\n  const dif = bonus - DC;\r\n  let chance;\r\n  if (dif < -29) {\r\n    chance = 5;\r\n  } else if (dif < -20) {\r\n    chance = (29 + dif) * 5;\r\n  } else if (dif < -10) {\r\n    chance = 45;\r\n  } else if (dif < -1) {\r\n    chance = (-2 - dif) * 5;\r\n  } else if (dif < 9) {\r\n    chance = 5;\r\n  } else {\r\n    chance = 0;\r\n  }\r\n\r\n  return chance;\r\n}\r\n\r\nfunction getCritFailurePercent(bonus, DC, keen = false) {\r\n  const dif = bonus - DC;\r\n  let chance;\r\n  if (dif < -29) {\r\n    chance = 95;\r\n  } else if (dif < -10) {\r\n    chance = (-10 - dif) * 5;\r\n  } else if (dif < -1) {\r\n    chance = 5;\r\n  } else {\r\n    chance = 0;\r\n  }\r\n\r\n  return chance;\r\n}\r\n\r\nconst addDamage = (\r\n  context,\r\n  type,\r\n  material,\r\n  persistent,\r\n  staticDamage,\r\n  damageDist,\r\n  multiplier\r\n) => {\r\n  if (persistent) {\r\n    context = context.persistent;\r\n  } else {\r\n    context = context.normal;\r\n  }\r\n  [staticDamage, damageDist] = multiplyDist(\r\n    staticDamage,\r\n    damageDist,\r\n    multiplier\r\n  );\r\n  if (!(type in context)) {\r\n    context[type] = { material, staticDamage, damageDist };\r\n  } else {\r\n    context[type].staticDamage += staticDamage;\r\n    context[type].damageDist = convolve(context[type].damageDist, damageDist);\r\n    if (material !== materials.NONE) context[type].material = material;\r\n  }\r\n};\r\n\r\nfunction calculateExpectedDamage(\r\n  activity,\r\n  damages,\r\n  target,\r\n  weaknesses,\r\n  defenseBonus\r\n) {\r\n  let bonus;\r\n  let DC;\r\n  switch (activity.type) {\r\n    case activityTypes.STRIKE:\r\n      bonus = activity.value;\r\n      bonus += MAPvalues[activity.MAP];\r\n      DC = target[activity.targetType] + defenseBonus;\r\n      if (activity.targetType === defenses.AC) {\r\n        if (target.flatfooted) DC -= 2;\r\n      } else {\r\n        DC += 10;\r\n      }\r\n      break;\r\n\r\n    case activityTypes.SAVE:\r\n      bonus = target[activity.targetType] + defenseBonus;\r\n      DC = activity.value;\r\n      if (activity.targetType === defenses.AC) {\r\n        bonus -= 10;\r\n      }\r\n      break;\r\n\r\n    default:\r\n      console.log(`Activity type ${activity.type} not implemented`);\r\n  }\r\n\r\n  let critPercent = getCritSuccessPercent(bonus, DC);\r\n  let succPercent = getSuccessPercent(bonus, DC);\r\n  let failPercent = getFailurePercent(bonus, DC);\r\n  let crfaPercent = getCritFailurePercent(bonus, DC);\r\n  if (activity.rollType === rollTypes.ADVANTAGE) {\r\n    let notcrit = 100 - critPercent;\r\n    critPercent = 100 - (notcrit * notcrit) / 100;\r\n    let nothit = notcrit - succPercent;\r\n    succPercent = 100 - (nothit * nothit) / 100 - critPercent;\r\n    let notfail = nothit - failPercent;\r\n    failPercent = 100 - (notfail * notfail) / 100 - succPercent - critPercent;\r\n    crfaPercent = (crfaPercent * crfaPercent) / 100;\r\n  } else if (activity.rollType === rollTypes.DISADVANTAGE) {\r\n    let notcrfa = 100 - crfaPercent;\r\n    crfaPercent = 100 - (notcrfa * notcrfa) / 100;\r\n    let notfail = notcrfa - failPercent;\r\n    failPercent = 100 - (notfail * notfail) / 100 - crfaPercent;\r\n    let notsucc = notfail - succPercent;\r\n    succPercent = 100 - (notsucc * notsucc) / 100 - failPercent - crfaPercent;\r\n    critPercent = (critPercent * critPercent) / 100;\r\n  }\r\n  const chances = [\r\n    critPercent / 100,\r\n    succPercent / 100,\r\n    failPercent / 100,\r\n    crfaPercent / 100,\r\n  ];\r\n  const critDamages = { normal: {}, persistent: {} };\r\n  const succDamages = { normal: {}, persistent: {} };\r\n  const failDamages = { normal: {}, persistent: {} };\r\n  const crfaDamages = { normal: {}, persistent: {} };\r\n  const damageTrees = [critDamages, succDamages, failDamages, crfaDamages];\r\n\r\n  // go through each damage and evaluate it, put damage types together\r\n  damages.forEach((damage) => {\r\n    let {\r\n      damageCondition,\r\n      diceNum,\r\n      diceSize,\r\n      staticDamage,\r\n      damageType,\r\n      material,\r\n      persistent,\r\n    } = damage;\r\n    if (!staticDamage) staticDamage = 0;\r\n\r\n    let damageDist = [1];\r\n    const diceArray = [];\r\n    for (let i = 0; i < diceSize; i++) {\r\n      diceArray.push(1 / diceSize);\r\n    }\r\n    for (let i = 0; i < diceNum; i++) {\r\n      damageDist = convolve(damageDist, diceArray);\r\n    }\r\n    staticDamage += diceNum;\r\n\r\n    switch (damageCondition) {\r\n      case dCond.STRIKE:\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          critDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          2\r\n        );\r\n        break;\r\n\r\n      case dCond.BASIC:\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          0.5\r\n        );\r\n        addDamage(\r\n          failDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          crfaDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          2\r\n        );\r\n        break;\r\n\r\n      case dCond.CRIF:\r\n        addDamage(\r\n          crfaDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.FAIL:\r\n        addDamage(\r\n          failDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.SUCC:\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.CRIT:\r\n        addDamage(\r\n          critDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.AT_LEAST_SUCC:\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          critDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.AT_LEAST_FAIL:\r\n        addDamage(\r\n          failDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          critDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.FAIL_WORSE:\r\n        addDamage(\r\n          crfaDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          failDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      case dCond.SUCC_WORSE:\r\n        addDamage(\r\n          crfaDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          failDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n\r\n        break;\r\n\r\n      case dCond.ALWAYS:\r\n        addDamage(\r\n          crfaDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          failDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          succDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        addDamage(\r\n          critDamages,\r\n          damageType,\r\n          material,\r\n          persistent,\r\n          staticDamage,\r\n          damageDist,\r\n          1\r\n        );\r\n        break;\r\n\r\n      default:\r\n        console.log(\r\n          `Damage condition ${damage.condition} not implemented yet.`\r\n        );\r\n    }\r\n  });\r\n\r\n  // for each damage group\r\n  // console.log(damageTrees);\r\n  for (let damageTree of damageTrees) {\r\n    for (let damageQuality of [\"normal\", \"persistent\"]) {\r\n      let totalStaticDamage = 0;\r\n      let totalDamageDist = [1];\r\n      for (let type in damageTree[damageQuality]) {\r\n        let { material, staticDamage, damageDist } =\r\n          damageTree[damageQuality][type];\r\n        // console.log(type);\r\n        // make min damage 1 before resistances\r\n        if (staticDamage < 0)\r\n          [staticDamage, damageDist] = applyMin(staticDamage, damageDist, 1);\r\n\r\n        // find max weakness and resistance, weaknesses are negative numbers\r\n        let maxW = 0;\r\n        let maxR = 0;\r\n        weaknesses.forEach((weakness) => {\r\n          if (weakness.type === type || weakness.type === material) {\r\n            if (weakness.value < 0) {\r\n              maxW = Math.min(maxW, weakness.value);\r\n            } else if (weakness.value > 0) {\r\n              maxR = Math.max(maxR, weakness.value);\r\n            }\r\n          }\r\n        });\r\n        staticDamage = staticDamage - (maxR + maxW);\r\n\r\n        // make min damage 0 after resistances\r\n        [staticDamage, damageDist] = applyMin(staticDamage, damageDist, 0);\r\n\r\n        // console.log([staticDamage, damageDist]);\r\n\r\n        // damageTree[damageQuality][type].staticDamage = staticDamage;\r\n        // damageTree[damageQuality][type].damageDist = damageDist;\r\n        totalStaticDamage += staticDamage;\r\n        totalDamageDist = convolve(totalDamageDist, damageDist);\r\n      }\r\n      damageTree[damageQuality].staticDamage = totalStaticDamage;\r\n      damageTree[damageQuality].damageDist = totalDamageDist;\r\n    }\r\n  }\r\n\r\n  return [damageTrees, chances];\r\n}\r\n\r\nexport { calculateExpectedDamage };\r\n","import { convolve, consolidateDists } from \"./Distribution\";\r\nimport { calculateExpectedDamage } from \"./Calculation\";\r\nimport { conditions } from \"../types\";\r\n\r\nclass ActivityPathEvaluator {\r\n  constructor(activityPaths, targets, damages, weaknesses) {\r\n    this.activityPaths = activityPaths;\r\n    this.targets = targets;\r\n    this.damages = damages;\r\n    this.weaknesses = weaknesses;\r\n  }\r\n\r\n  evalPath(activityPath, defenseBonus) {\r\n    let currentTarget = this.targets[0];\r\n    let currentDamages = activityPath.damages.map(\r\n      (damageId) => this.damages[damageId]\r\n    );\r\n    currentDamages.push(activityPath);\r\n    let currentWeaknesses = currentTarget.weaknesses.map(\r\n      (weaknessId) => this.weaknesses[weaknessId]\r\n    );\r\n\r\n    // damage tress = [critDamages, succDamages, failDamages, crfaDamages]\r\n    // critDamages = {normal, persistent}\r\n    // normal = {fire..., staticDamage, damageDist}\r\n    let [damageTrees, chances] = calculateExpectedDamage(\r\n      activityPath,\r\n      currentDamages,\r\n      currentTarget,\r\n      currentWeaknesses,\r\n      defenseBonus\r\n    );\r\n    // console.log(`chances are ${chances}`);\r\n\r\n    // go through each activity path, depending on its condition add its damage distributions to this activities appropriately\r\n    activityPath.apIds.forEach((apId) => {\r\n      let ap = this.activityPaths[apId];\r\n      let [pathDist, pathPDist] = this.evalPath(ap, defenseBonus);\r\n\r\n      let indicies = [];\r\n      // console.log(`cond is: ${ap.condition}`);\r\n      switch (ap.condition) {\r\n        case conditions.ALWAYS:\r\n          indicies = [0, 1, 2, 3];\r\n          break;\r\n\r\n        case conditions.AT_LEAST_FAIL:\r\n          indicies = [0, 1, 2];\r\n          break;\r\n\r\n        case conditions.AT_LEAST_SUCC:\r\n          indicies = [0, 1];\r\n          break;\r\n\r\n        case conditions.CRIF:\r\n          indicies = [3];\r\n          break;\r\n\r\n        case conditions.CRIT:\r\n          indicies = [0];\r\n          break;\r\n\r\n        case conditions.FAIL:\r\n          indicies = [2];\r\n          break;\r\n\r\n        case conditions.FAIL_WORSE:\r\n          indicies = [2, 3];\r\n          break;\r\n\r\n        case conditions.SUCC:\r\n          indicies = [1];\r\n          break;\r\n\r\n        case conditions.SUCC_WORSE:\r\n          indicies = [1, 2, 3];\r\n          break;\r\n\r\n        default:\r\n      }\r\n      // console.log(`indies are: ${indicies}`);\r\n      for (let index of indicies) {\r\n        // console.log(\r\n        //   `adding damage to index ${index} w/ chance ${chances[index]}`\r\n        // );\r\n        // damageTrees[index].normal.staticDamage += pathSD;\r\n        damageTrees[index].normal.damageDist = convolve(\r\n          damageTrees[index].normal.damageDist,\r\n          pathDist\r\n        );\r\n        // damageTrees[index].persistent.staticDamage += pathPSD;\r\n        damageTrees[index].persistent.damageDist = convolve(\r\n          damageTrees[index].persistent.damageDist,\r\n          pathPDist\r\n        );\r\n      }\r\n      // console.log(pathChance);\r\n    });\r\n\r\n    let damageDist = consolidateDists(\r\n      [damageTrees[0].normal, chances[0]],\r\n      [damageTrees[1].normal, chances[1]],\r\n      [damageTrees[2].normal, chances[2]],\r\n      [damageTrees[3].normal, chances[3]]\r\n    );\r\n    let PdamageDist = consolidateDists(\r\n      [damageTrees[0].persistent, chances[0]],\r\n      [damageTrees[1].persistent, chances[1]],\r\n      [damageTrees[2].persistent, chances[2]],\r\n      [damageTrees[3].persistent, chances[3]]\r\n    );\r\n\r\n    return [damageDist, PdamageDist];\r\n  }\r\n}\r\n\r\nexport default ActivityPathEvaluator;\r\n","import React, { useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { convolve } from \"../Calculation/Distribution\";\r\nimport { selectactivityPathEntities } from \"../Routine/activityPathSlice\";\r\nimport { selectdamageEntities } from \"../Routine/damageSlice\";\r\nimport { selectRoutineEntities } from \"../Routine/routineSlice\";\r\nimport { selecttargetEntities } from \"../Target/targetSlice\";\r\nimport { selectweaknessEntities } from \"../Target/weaknessSlice\";\r\n\r\nimport ActivityPathEvaluator from \"../Calculation/EvaluateActivityPath\";\r\n\r\n// import Plot from \"react-plotly.js\";\r\nimport Plotly from \"plotly.js-basic-dist\";\r\nimport createPlotlyComponent from \"react-plotly.js/factory\";\r\nimport { defenses, graphTypes } from \"../types\";\r\nconst Plot = createPlotlyComponent(Plotly);\r\n\r\nconst Display = () => {\r\n  // evaluates routines and displays appropriate graphs\r\n\r\n  const [addPersistent, setAddPersistent] = useState(false);\r\n  const [graphType, setGraphType] = useState(graphTypes.DISTRIBUTION);\r\n  // const [perMulti, setPerMulti] = useState(2);\r\n\r\n  const routines = useSelector(selectRoutineEntities);\r\n  const activityPaths = useSelector(selectactivityPathEntities);\r\n  const targets = useSelector(selecttargetEntities);\r\n  const damages = useSelector(selectdamageEntities);\r\n  const weaknesses = useSelector(selectweaknessEntities);\r\n\r\n  const currentTarget = targets[0];\r\n  let title = \"Expected Damage\";\r\n  if (\r\n    graphType === graphTypes.DISTRIBUTION ||\r\n    graphType === graphTypes.PMDEFENSE\r\n  ) {\r\n    title += \" Vs \";\r\n    title += \" AC: \" + currentTarget[defenses.AC];\r\n    title += \" Fort: \" + currentTarget[defenses.FORT];\r\n    title += \" Ref: \" + currentTarget[defenses.REF];\r\n    title += \" Will: \" + currentTarget[defenses.WILL];\r\n    title += \" Per: \" + currentTarget[defenses.PER];\r\n  } else if (graphType === graphTypes.BYLEVEL) {\r\n  }\r\n\r\n  const evaluator = new ActivityPathEvaluator(\r\n    activityPaths,\r\n    targets,\r\n    damages,\r\n    weaknesses\r\n  );\r\n\r\n  let minbonus = 0;\r\n  let maxbonus = 0;\r\n  if (graphType === graphTypes.PMDEFENSE) {\r\n    minbonus = -5;\r\n    maxbonus = 5;\r\n  }\r\n\r\n  let maxDamage = 0;\r\n  let maxPDamage = 0;\r\n  const datasets = [];\r\n  const perDatasets = [];\r\n  const expectedDamages = [];\r\n  const expectedPersistentDamages = [];\r\n\r\n  // go through routines, evaluate them, and put data together for use in charts\r\n  for (let id in routines) {\r\n    let routine = routines[id];\r\n    if (!routine.display) continue;\r\n\r\n    const bonusArray = [];\r\n    const expDbyBonus = [];\r\n    const expPDbyBonus = [];\r\n    // if not doing a +/- graph, bonus is just 0\r\n    for (let bonus = minbonus; bonus <= maxbonus; bonus++) {\r\n      bonusArray.push(bonus);\r\n      // calculate distribution for this routine with this bonus\r\n      let expD = 0;\r\n      let expP = 0;\r\n      let routineDDist = [1];\r\n      let routinePDDist = [1];\r\n      for (let i = 0; i < routine.apIds.length; i++) {\r\n        let activityPath = activityPaths[routine.apIds[i]];\r\n        let [damageDist, PdamageDist] = evaluator.evalPath(activityPath, bonus);\r\n        routineDDist = convolve(routineDDist, damageDist);\r\n        routinePDDist = convolve(routinePDDist, PdamageDist);\r\n      }\r\n      maxDamage = Math.max(maxDamage, routineDDist.length - 1);\r\n      maxPDamage = Math.max(maxPDamage, routinePDDist.length - 1);\r\n\r\n      const dataArray = [];\r\n      const cumulative = [];\r\n      const PdataArray = [];\r\n      const Pcumulative = [];\r\n\r\n      let currentSum = 1;\r\n      for (let i = 0; i < routineDDist.length; i++) {\r\n        if (graphType === graphTypes.DISTRIBUTION) {\r\n          dataArray.push(i);\r\n          cumulative.push(currentSum);\r\n          currentSum -= routineDDist[i];\r\n        }\r\n        expD += routineDDist[i] * i;\r\n      }\r\n      currentSum = 1;\r\n      for (let i = 0; i < routinePDDist.length; i++) {\r\n        if (graphType === graphTypes.DISTRIBUTION) {\r\n          PdataArray.push(i);\r\n          Pcumulative.push(currentSum);\r\n          currentSum -= routinePDDist[i];\r\n        }\r\n        expP += routinePDDist[i] * i;\r\n      }\r\n\r\n      // add data depending on chart type\r\n      if (bonus === 0) {\r\n        expectedDamages.push(\r\n          <div key={routine.id}>\r\n            {routine.name}\r\n            {\": \"}\r\n            {expD.toFixed(2)}\r\n          </div>\r\n        );\r\n        expectedPersistentDamages.push(\r\n          <div key={routine.id}>\r\n            {routine.name}\r\n            {\": \"}\r\n            {expP.toFixed(2)}\r\n          </div>\r\n        );\r\n      }\r\n      if (graphType === graphTypes.DISTRIBUTION) {\r\n        datasets.push({\r\n          type: \"scatter\",\r\n          name: routine.name,\r\n          x: dataArray,\r\n          y: cumulative,\r\n          yaxis: \"y\",\r\n        });\r\n        datasets.push({\r\n          type: \"bar\",\r\n          name: expD.toFixed(2),\r\n          x: dataArray,\r\n          y: routineDDist,\r\n        });\r\n        perDatasets.push({\r\n          type: \"scatter\",\r\n          name: routine.name,\r\n          x: PdataArray,\r\n          y: Pcumulative,\r\n        });\r\n        perDatasets.push({\r\n          type: \"bar\",\r\n          name: expP.toFixed(2),\r\n          x: PdataArray,\r\n          y: routinePDDist,\r\n        });\r\n      } else if (graphType === graphTypes.PMDEFENSE) {\r\n        expDbyBonus.push(expD);\r\n        expPDbyBonus.push(expP);\r\n      }\r\n    }\r\n    if (graphType === graphTypes.PMDEFENSE) {\r\n      datasets.push({\r\n        type: \"scatter\",\r\n        name: routine.name,\r\n        x: bonusArray,\r\n        y: expDbyBonus,\r\n        yaxis: \"y\",\r\n      });\r\n      perDatasets.push({\r\n        type: \"scatter\",\r\n        name: routine.name,\r\n        x: bonusArray,\r\n        y: expPDbyBonus,\r\n        yaxis: \"y\",\r\n      });\r\n    }\r\n  }\r\n  // Done evaluating routines and putting data together\r\n\r\n  // create appropriate labels and charts\r\n  const labels = [];\r\n  const Plabels = [];\r\n  let xtitle;\r\n  let ytitle;\r\n  if (graphType === graphTypes.DISTRIBUTION) {\r\n    xtitle = \"damage\";\r\n    ytitle = \"chance\";\r\n    for (let i = 0; i <= maxDamage; i++) {\r\n      labels.push(i);\r\n    }\r\n    for (let i = 0; i <= maxPDamage; i++) {\r\n      Plabels.push(i);\r\n    }\r\n  } else if (graphType === graphTypes.PMDEFENSE) {\r\n    xtitle = \"+/- AC/Save Bonus\";\r\n    ytitle = \"Expected Damage\";\r\n    for (let i = minbonus; i <= maxbonus; i++) {\r\n      labels.push(i);\r\n      Plabels.push(i);\r\n    }\r\n  }\r\n\r\n  let damageChart = (\r\n    <Plot\r\n      classname=\"plot\"\r\n      data={datasets}\r\n      layout={{\r\n        title: title,\r\n        autosize: true,\r\n        xaxis: { title: xtitle },\r\n        yaxis: { title: ytitle },\r\n        legend: {\r\n          x: 1,\r\n          y: 1,\r\n          xanchor: \"right\",\r\n        },\r\n        margin: {\r\n          l: 40,\r\n          r: 40,\r\n        },\r\n      }}\r\n      useResizeHandler={true}\r\n      style={{ width: \"100%\", height: \"100%\" }}\r\n    />\r\n  );\r\n  let persistentDamageChart = (\r\n    <Plot\r\n      classname=\"plot\"\r\n      data={perDatasets}\r\n      layout={{\r\n        title: \"Expected Persistent Damage\",\r\n        autosize: true,\r\n        xaxis: { title: \"persistent damage\" },\r\n        yaxis: { title: \"chance\" },\r\n        legend: {\r\n          x: 1,\r\n          y: 1,\r\n          xanchor: \"right\",\r\n        },\r\n        margin: {\r\n          l: 40,\r\n          r: 40,\r\n        },\r\n      }}\r\n      useResizeHandler={true}\r\n      style={{ width: \"100%\", height: \"100%\" }}\r\n    />\r\n  );\r\n\r\n  const graphTypeOptions = [];\r\n  for (let gt in graphTypes) {\r\n    graphTypeOptions.push(<option key={gt}>{graphTypes[gt]}</option>);\r\n  }\r\n\r\n  return (\r\n    <div className=\"box\">\r\n      {\"Graph Type: \"}\r\n      <select value={graphType} onChange={(e) => setGraphType(e.target.value)}>\r\n        {graphTypeOptions}\r\n      </select>\r\n      {\" Show persistent damage: \"}\r\n      <input\r\n        type=\"checkbox\"\r\n        checked={addPersistent}\r\n        onChange={(e) => setAddPersistent(e.target.checked)}\r\n      />\r\n      {/* , persistent damage multiplier:\r\n      <input\r\n        type=\"number\"\r\n        value={perMulti ? perMulti : 0}\r\n        onChange={(e) => setPerMulti(e.target.valueAsNumber)}\r\n      /> */}\r\n      <div>\r\n        Expected Damage:\r\n        {expectedDamages}\r\n      </div>\r\n      {damageChart}\r\n      {!addPersistent ? (\r\n        \"\"\r\n      ) : (\r\n        <div>\r\n          <div>\r\n            Expected Persistent Damage:\r\n            {expectedPersistentDamages}\r\n          </div>\r\n          {persistentDamageChart}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Display;\r\n","import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  activityTypes,\r\n  conditions,\r\n  damageTypes,\r\n  dCond,\r\n  defaultActivities,\r\n  defenses,\r\n  diceNums,\r\n  diceSizes,\r\n  MAPs,\r\n  materials,\r\n  rollTypes,\r\n} from \"../types\";\r\nimport {\r\n  activityPathCreated,\r\n  activityPathUpdated,\r\n  activityPathRemoved,\r\n  selectactivityPathById,\r\n} from \"./activityPathSlice\";\r\n\r\nimport {\r\n  damageCreated,\r\n  damageRemoved,\r\n  damageUpdated,\r\n  selectdamageById,\r\n} from \"./damageSlice\";\r\nimport { routineUpdated, selectRoutineById } from \"./routineSlice\";\r\n\r\nconst conditionOptions = [];\r\nfor (let c in conditions) {\r\n  conditionOptions.push(<option key={c}>{conditions[c]}</option>);\r\n}\r\nconst defaultActivityOptions = [];\r\nfor (let da in defaultActivities) {\r\n  defaultActivityOptions.push(\r\n    <option key={da}>{defaultActivities[da]}</option>\r\n  );\r\n}\r\n\r\nconst activityTypeOptions = [];\r\nfor (let at in activityTypes) {\r\n  activityTypeOptions.push(<option key={at}>{activityTypes[at]}</option>);\r\n}\r\nconst MAPOptions = [];\r\nfor (let m in MAPs) {\r\n  MAPOptions.push(<option key={m}>{MAPs[m]}</option>);\r\n}\r\nconst defenseOptions = [];\r\nfor (let d in defenses) {\r\n  defenseOptions.push(<option key={d}>{defenses[d]}</option>);\r\n}\r\nconst rollOptions = [];\r\nfor (let rt in rollTypes) {\r\n  rollOptions.push(<option key={rt}>{rollTypes[rt]}</option>);\r\n}\r\n\r\nconst damageConditionOptions = [];\r\nfor (let dc in dCond) {\r\n  damageConditionOptions.push(<option key={dc}>{dCond[dc]}</option>);\r\n}\r\nconst diceNumOptions = [];\r\nfor (let dn in diceNums) {\r\n  diceNumOptions.push(<option key={dn}>{dn}</option>);\r\n}\r\nconst diceSizeOptions = [];\r\nfor (let ds in diceSizes) {\r\n  diceSizeOptions.push(<option key={ds}>{ds}</option>);\r\n}\r\nconst damageTypeOptions = [];\r\nfor (let dt in damageTypes) {\r\n  damageTypeOptions.push(<option key={dt}>{damageTypes[dt]}</option>);\r\n}\r\nconst materialOptions = [];\r\nfor (let m in materials) {\r\n  materialOptions.push(<option key={m}>{materials[m]}</option>);\r\n}\r\n\r\nfunction SelectedRoutine({ routineId }) {\r\n  // const selectedRoutine = useSelector(selectSelectedRoutine);\r\n  const apIds = useSelector((state) =>\r\n    selectRoutineById(state, routineId)\r\n  ).apIds;\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <div className=\"selectedRoutine\">\r\n      <NameInput id={routineId} />\r\n      {apIds.map((apId) => (\r\n        <ActivityPath\r\n          id={apId}\r\n          routineId={routineId}\r\n          key={apId}\r\n          displayCondition={false}\r\n        />\r\n      ))}\r\n      <button\r\n        className=\"add\"\r\n        onClick={() => dispatch(activityPathCreated({ routineId: routineId }))}\r\n      >\r\n        +\r\n      </button>\r\n      {/* <EffectInput /> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst NameInput = ({ id }) => {\r\n  const dispatch = useDispatch();\r\n  const name = useSelector((state) => selectRoutineById(state, id)).name;\r\n\r\n  return (\r\n    <div className=\"box\">\r\n      <label htmlFor=\"routineName\">Routine Name:</label>\r\n      <input\r\n        id=\"routineName\"\r\n        type=\"text\"\r\n        placeholder=\"Enter routine name\"\r\n        value={name}\r\n        onChange={(e) =>\r\n          dispatch(routineUpdated({ id, changes: { name: e.target.value } }))\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ActivityPath = ({ id, parentId, routineId, displayCondition = true }) => {\r\n  const {\r\n    condition,\r\n    level,\r\n    override,\r\n    defaultActivity,\r\n    type,\r\n    targetType,\r\n    value,\r\n    MAP,\r\n    rollType,\r\n    damageCondition,\r\n    diceNum,\r\n    diceSize,\r\n    staticDamage,\r\n    damageType,\r\n    material,\r\n    damages,\r\n    effects,\r\n    apIds,\r\n  } = useSelector((state) => selectactivityPathById(state, id));\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <div className=\"box\">\r\n      {displayCondition ? (\r\n        <div>\r\n          {\"Condition: \"}\r\n          <select\r\n            value={condition}\r\n            onChange={(e) =>\r\n              dispatch(\r\n                activityPathUpdated({\r\n                  id,\r\n                  changes: { condition: e.target.value },\r\n                })\r\n              )\r\n            }\r\n          >\r\n            {conditionOptions}\r\n          </select>\r\n        </div>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n\r\n      <div className=\"\">\r\n        <div className=\"flexbox\">\r\n          <button\r\n            className=\"delete\"\r\n            onClick={(e) => {\r\n              dispatch(activityPathRemoved({ id, parentId, routineId }));\r\n            }}\r\n          >\r\n            -\r\n          </button>\r\n          <span className=\"input\">\r\n            <label htmlFor=\"override\">{\"Override: \"}</label>\r\n            <input\r\n              id=\"override\"\r\n              type=\"checkbox\"\r\n              checked={override}\r\n              onChange={(e) =>\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: { override: e.target.checked },\r\n                  })\r\n                )\r\n              }\r\n            />\r\n          </span>\r\n          <span className=\"input\">\r\n            <label htmlFor=\"Level\">{\" Level: \"}</label>\r\n            <input\r\n              id=\"Level\"\r\n              type=\"number\"\r\n              value={level}\r\n              min={1}\r\n              max={20}\r\n              onChange={(e) => {\r\n                let level = parseInt(e.target.value) || 1;\r\n                if (level > 20) level = 20;\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: {\r\n                      level,\r\n                    },\r\n                  })\r\n                );\r\n              }}\r\n            />\r\n          </span>\r\n\r\n          <span className=\"input\">\r\n            {/* <input\r\n              type=\"checkbox\"\r\n              checked={useDefault}\r\n              onChange={(e) =>\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: { useDefault: e.target.checked },\r\n                  })\r\n                )\r\n              }\r\n            /> */}\r\n            <select\r\n              value={defaultActivity}\r\n              onChange={(e) =>\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: { defaultActivity: e.target.value },\r\n                  })\r\n                )\r\n              }\r\n            >\r\n              {defaultActivityOptions}\r\n            </select>\r\n          </span>\r\n\r\n          <span className=\"input\">\r\n            <select\r\n              value={type}\r\n              onChange={(e) =>\r\n                dispatch(\r\n                  activityPathUpdated({ id, changes: { type: e.target.value } })\r\n                )\r\n              }\r\n            >\r\n              {activityTypeOptions}\r\n            </select>\r\n            {type === activityTypes.STRIKE ? \" +\" : \" DC: \"}\r\n            <input\r\n              type=\"number\"\r\n              value={value ? value : 0}\r\n              onChange={(e) =>\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: { value: parseInt(e.target.value) },\r\n                  })\r\n                )\r\n              }\r\n            />\r\n          </span>\r\n          <span className=\"input\">\r\n            {\" MAP: \"}\r\n            <select\r\n              value={MAP}\r\n              onChange={(e) =>\r\n                dispatch(\r\n                  activityPathUpdated({ id, changes: { MAP: e.target.value } })\r\n                )\r\n              }\r\n            >\r\n              {MAPOptions}\r\n            </select>\r\n          </span>\r\n          <span className=\"input\">\r\n            {\" VS: \"}\r\n            <select\r\n              value={targetType}\r\n              onChange={(e) => {\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: { targetType: e.target.value },\r\n                  })\r\n                );\r\n              }}\r\n            >\r\n              {defenseOptions}\r\n            </select>\r\n          </span>\r\n          <span className=\"input\">\r\n            <select\r\n              value={rollType}\r\n              onChange={(e) => {\r\n                dispatch(\r\n                  activityPathUpdated({\r\n                    id,\r\n                    changes: { rollType: e.target.value },\r\n                  })\r\n                );\r\n              }}\r\n            >\r\n              {rollOptions}\r\n            </select>\r\n          </span>\r\n        </div>\r\n        <div className=\"flexbox\">\r\n          Damage:\r\n          <select\r\n            value={damageCondition}\r\n            onChange={(e) =>\r\n              dispatch(\r\n                activityPathUpdated({\r\n                  id,\r\n                  changes: { damageCondition: e.target.value },\r\n                })\r\n              )\r\n            }\r\n          >\r\n            {damageConditionOptions}\r\n          </select>\r\n          <select\r\n            value={diceNum}\r\n            onChange={(e) =>\r\n              dispatch(\r\n                activityPathUpdated({\r\n                  id,\r\n                  changes: { diceNum: parseInt(e.target.value) },\r\n                })\r\n              )\r\n            }\r\n          >\r\n            {diceNumOptions}\r\n          </select>\r\n          d\r\n          <select\r\n            value={diceSize}\r\n            onChange={(e) =>\r\n              dispatch(\r\n                activityPathUpdated({\r\n                  id,\r\n                  changes: { diceSize: parseInt(e.target.value) },\r\n                })\r\n              )\r\n            }\r\n          >\r\n            {diceSizeOptions}\r\n          </select>\r\n          {\" + \"}\r\n          <input\r\n            type=\"number\"\r\n            value={staticDamage}\r\n            onChange={(e) =>\r\n              dispatch(\r\n                activityPathUpdated({\r\n                  id,\r\n                  changes: { staticDamage: parseInt(e.target.value) },\r\n                })\r\n              )\r\n            }\r\n          />\r\n          <select\r\n            value={damageType}\r\n            onChange={(e) => {\r\n              dispatch(\r\n                activityPathUpdated({\r\n                  id,\r\n                  changes: { damageType: e.target.value },\r\n                })\r\n              );\r\n            }}\r\n          >\r\n            {damageTypeOptions}\r\n          </select>\r\n          <select\r\n            value={material}\r\n            onChange={(e) => {\r\n              dispatch(\r\n                damageUpdated({ id, changes: { material: e.target.value } })\r\n              );\r\n            }}\r\n          >\r\n            {materialOptions}\r\n          </select>\r\n        </div>\r\n        <div className=\"box\">\r\n          {\"Additional Damage: \"}\r\n          {damages.map((damageId) => (\r\n            <Damage parentId={id} id={damageId} key={damageId} />\r\n          ))}\r\n          <button\r\n            className=\"add\"\r\n            onClick={() => dispatch(damageCreated({ parentId: id }))}\r\n          >\r\n            +\r\n          </button>\r\n        </div>\r\n        <div className=\"box\">Effects: {effects}</div>\r\n      </div>\r\n\r\n      <div className=\"box\">\r\n        {apIds.map((apId) => (\r\n          <ActivityPath id={apId} parentId={id} key={apId} />\r\n        ))}\r\n        <button\r\n          className=\"add\"\r\n          onClick={() => dispatch(activityPathCreated({ parentId: id }))}\r\n        >\r\n          +\r\n        </button>\r\n        <button\r\n          className=\"add\"\r\n          onClick={() =>\r\n            dispatch(activityPathCreated({ parentId: id, applyMAP: true }))\r\n          }\r\n        >\r\n          +MAP\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Damage = ({ parentId, id }) => {\r\n  const {\r\n    damageCondition,\r\n    diceNum,\r\n    diceSize,\r\n    staticDamage,\r\n    damageType,\r\n    material,\r\n    persistent,\r\n  } = useSelector((state) => selectdamageById(state, id));\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <div className=\"box\">\r\n      <button\r\n        className=\"delete\"\r\n        onClick={(e) => {\r\n          dispatch(damageRemoved({ id, parentId }));\r\n        }}\r\n      >\r\n        -\r\n      </button>\r\n      <select\r\n        value={damageCondition}\r\n        onChange={(e) =>\r\n          dispatch(\r\n            damageUpdated({ id, changes: { damageCondition: e.target.value } })\r\n          )\r\n        }\r\n      >\r\n        {damageConditionOptions}\r\n      </select>\r\n      <select\r\n        value={diceNum}\r\n        onChange={(e) =>\r\n          dispatch(\r\n            damageUpdated({\r\n              id,\r\n              changes: { diceNum: parseInt(e.target.value) },\r\n            })\r\n          )\r\n        }\r\n      >\r\n        {diceNumOptions}\r\n      </select>\r\n      d\r\n      <select\r\n        value={diceSize}\r\n        onChange={(e) =>\r\n          dispatch(\r\n            damageUpdated({\r\n              id,\r\n              changes: { diceSize: parseInt(e.target.value) },\r\n            })\r\n          )\r\n        }\r\n      >\r\n        {diceSizeOptions}\r\n      </select>\r\n      {\" + \"}\r\n      <input\r\n        type=\"number\"\r\n        value={staticDamage}\r\n        onChange={(e) =>\r\n          dispatch(\r\n            damageUpdated({\r\n              id,\r\n              changes: { staticDamage: parseInt(e.target.value) },\r\n            })\r\n          )\r\n        }\r\n      />\r\n      <select\r\n        value={damageType}\r\n        onChange={(e) => {\r\n          dispatch(\r\n            damageUpdated({ id, changes: { damageType: e.target.value } })\r\n          );\r\n        }}\r\n      >\r\n        {damageTypeOptions}\r\n      </select>\r\n      <select\r\n        value={material}\r\n        onChange={(e) => {\r\n          dispatch(\r\n            damageUpdated({ id, changes: { material: e.target.value } })\r\n          );\r\n        }}\r\n      >\r\n        {materialOptions}\r\n      </select>\r\n      {\" Persistent: \"}\r\n      <input\r\n        type=\"checkbox\"\r\n        checked={persistent}\r\n        onChange={(e) =>\r\n          dispatch(\r\n            damageUpdated({\r\n              id,\r\n              changes: { persistent: e.target.checked },\r\n            })\r\n          )\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SelectedRoutine;\r\n","import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  routineCreated,\r\n  routineRemoved,\r\n  routineUpdated,\r\n  selectAllRoutines,\r\n  selectSelectedRoutine,\r\n  setRoutine,\r\n} from \"./Routine/routineSlice\";\r\n\r\nconst Routines = () => {\r\n  const routines = useSelector(selectAllRoutines);\r\n  const selectedRoutine = useSelector(selectSelectedRoutine);\r\n  const dispatch = useDispatch();\r\n\r\n  const routineOptions = [];\r\n  const routineDisplays = [];\r\n  routines.forEach((routine) => {\r\n    routineOptions.push(\r\n      <option value={routine.id} key={routine.id}>\r\n        {routine.name}\r\n      </option>\r\n    );\r\n    routineDisplays.push(\r\n      <div className=\"flexbox\" key={routine.id}>\r\n        <button\r\n          className=\"remove\"\r\n          onClick={() => dispatch(routineRemoved(routine.id))}\r\n        >\r\n          -\r\n        </button>\r\n        <span\r\n          className={routine.display ? \"routineOn\" : \"routineOff\"}\r\n          onClick={() =>\r\n            dispatch(\r\n              routineUpdated({\r\n                id: routine.id,\r\n                changes: { display: !routine.display },\r\n              })\r\n            )\r\n          }\r\n        >\r\n          {routine.name}\r\n        </span>\r\n      </div>\r\n    );\r\n  });\r\n\r\n  return (\r\n    <div className=\"box\">\r\n      Selected Routine:\r\n      <select\r\n        value={selectedRoutine}\r\n        onChange={(e) => dispatch(setRoutine(e.target.value))}\r\n      >\r\n        {routineOptions}\r\n      </select>\r\n      <button className=\"add\" onClick={() => dispatch(routineCreated())}>\r\n        +\r\n      </button>\r\n      <div className=\"routines\">{routineDisplays}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Routines;\r\n","import React from \"react\";\r\n// import { useSelector } from \"react-redux\";\r\n\r\nconst ImportExport = () => {\r\n  return <div className=\"box\">Import and Export Here</div>;\r\n};\r\n\r\nexport default ImportExport;\r\n","import React from \"react\";\r\n// import { useSelector } from \"react-redux\";\r\n// import update from \"immutability-helper\";\r\n\r\n// //import { useSelector, useDispatch } from 'react-redux';\r\n// import { selectCurrentEffect } from \"./Effect/effectSlice\";\r\n\r\n// import {\r\n//   CheckboxInput,\r\n//   CollapsableInput,\r\n//   ByLevelInput,\r\n// } from \"./Effect/Inputs/CommonInputs.js\";\r\n\r\n// import MAP from \"./Effect/Model/MAP.js\";\r\n// import Proficiency from \"./Effect/Model/Proficiency.js\";\r\n// import AbilityScore from \"./Effect/Model/AbilityScore.js\";\r\n// import Modifier from \"./Effect/Model/Modifier.js\";\r\n// import AdditionalEffectArray from \"./Effect/Model/AdditionalEffectArray.js\";\r\n\r\n// import {\r\n//   totalBonusDescription,\r\n//   attackBonusDescription,\r\n//   totalDamageDescription,\r\n//   calculateExpectedDamage,\r\n// } from \"./Calculation.js\";\r\n\r\nimport TargetInput from \"./Target/TargetInput\";\r\nimport Display from \"./Display/Display\";\r\n// import { selectTarget, selectLevel } from \"./Target/targetSlice\";\r\n\r\nimport SelectedRoutine from \"./Routine/SelectedRoutine\";\r\nimport Routines from \"./Routines\";\r\nimport Export from \"./Export\";\r\n\r\nimport \"./PF2App.css\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { selectSelectedRoutine } from \"./Routine/routineSlice\";\r\n\r\n// function DisplayOutput(props) {\r\n//   // props: effect, target\r\n//   const target = useSelector(selectTarget);\r\n//   const effect = useSelector(selectCurrentEffect);\r\n//   return (\r\n//     <div className=\"Display\">\r\n//       <CollapsableInput\r\n//         description={\r\n//           \"Expected Damage: \" + calculateExpectedDamage(effect, target)\r\n//         }\r\n//         listInput=\"\"\r\n//       />\r\n//     </div>\r\n//   );\r\n// }\r\n\r\nfunction PF2App(props) {\r\n  const selectedRoutine = useSelector(selectSelectedRoutine);\r\n\r\n  return (\r\n    <div className=\"PF2App\">\r\n      <TargetInput id={0} />\r\n      <Display />\r\n      <Routines />\r\n      {selectedRoutine !== undefined ? (\r\n        <SelectedRoutine routineId={selectedRoutine} />\r\n      ) : (\r\n        \"\"\r\n      )}\r\n      {/* <SelectedRoutine /> */}\r\n\r\n      <Export />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PF2App;\r\n","import { createEntityAdapter, createSlice } from \"@reduxjs/toolkit\";\r\n\r\nexport const effectAdapter = createEntityAdapter();\r\n\r\nexport const effectsSlice = createSlice({\r\n  name: \"effects\",\r\n  initialState: effectAdapter.getInitialState(),\r\n  reducers: {\r\n    effectAdded: effectAdapter.addOne,\r\n    effectUpdated: effectAdapter.updateOne,\r\n  },\r\n});\r\n\r\nexport const { effectAdded, effectUpdated } = effectsSlice.actions;\r\n\r\nexport default effectsSlice.reducer;\r\n\r\nexport const {\r\n  selectById: selecteffectById,\r\n  selectIds: selecteffectIds,\r\n  selectEntities: selecteffectEntities,\r\n  selectAll: selectAlleffects,\r\n  selectTotal: selectTotaleffects,\r\n} = effectAdapter.getSelectors((state) => state.effects);\r\n","import { configureStore } from \"@reduxjs/toolkit\";\r\nimport routineReducer, { routineAdded } from \"./Routine/routineSlice\";\r\nimport activityPathReducer, {\r\n  activityPathAdded,\r\n} from \"./Routine/activityPathSlice\";\r\nimport damageReducer from \"./Routine/damageSlice\";\r\nimport effectReducer from \"./Routine/effectSlice\";\r\nimport targetReducer, { targetAdded } from \"./Target/targetSlice\";\r\nimport weaknessReducer from \"./Target/weaknessSlice\";\r\nimport {\r\n  activityTypes,\r\n  conditions,\r\n  damageTypes,\r\n  dCond,\r\n  defaultActivities,\r\n  defaultValuesAC,\r\n  defaultValuesSaves,\r\n  defenses,\r\n  MAPs,\r\n  materials,\r\n  rollTypes,\r\n} from \"./types\";\r\n\r\nexport const store = configureStore({\r\n  reducer: {\r\n    routines: routineReducer,\r\n    activityPaths: activityPathReducer,\r\n    damages: damageReducer,\r\n    effects: effectReducer,\r\n    weaknesses: weaknessReducer,\r\n    targets: targetReducer,\r\n  },\r\n});\r\n\r\nstore.dispatch(\r\n  routineAdded({ id: 0, name: \"Fighter\", display: true, apIds: [0] })\r\n);\r\n\r\nstore.dispatch(\r\n  activityPathAdded({\r\n    id: 0,\r\n    condition: conditions.ALWAYS,\r\n    override: false,\r\n    level: 1,\r\n    useDefault: false,\r\n    defaultActivity: defaultActivities.FIGHTER,\r\n    type: activityTypes.STRIKE,\r\n    targetType: defenses.AC,\r\n    targetInfoId: 0,\r\n    value: 9,\r\n    MAP: MAPs.N1,\r\n    rollType: rollTypes.NORMAL,\r\n    damageCondition: dCond.STRIKE,\r\n    diceNum: 1,\r\n    diceSize: 8,\r\n    staticDamage: 4,\r\n    damageType: damageTypes.S,\r\n    material: materials.NONE,\r\n    damages: [],\r\n    effects: [],\r\n    apIds: [],\r\n  })\r\n);\r\n\r\nstore.dispatch(\r\n  targetAdded({\r\n    id: 0,\r\n    name: \"Custom Target\",\r\n    overrideDefault: true,\r\n    addMods: false,\r\n    level: 1,\r\n    matchRoutines: true,\r\n    levelDiff: 0,\r\n    useDefaultAC: true,\r\n    defaultAC: defaultValuesAC.HIGH,\r\n    [defenses.AC]: 16,\r\n    useDefaultFort: true,\r\n    defaultFort: defaultValuesSaves.MODERATE,\r\n    [defenses.FORT]: 7,\r\n    useDefaultRef: true,\r\n    defaultRef: defaultValuesSaves.MODERATE,\r\n    [defenses.REF]: 7,\r\n    useDefaultWill: true,\r\n    defaultWill: defaultValuesSaves.MODERATE,\r\n    [defenses.WILL]: 7,\r\n    useDefaultPer: true,\r\n    defaultPer: defaultValuesSaves.MODERATE,\r\n    [defenses.PER]: 7,\r\n    flatfooted: false,\r\n    weaknesses: [],\r\n  })\r\n);\r\n// store.dispatch(weaknessAdded({ id: 0, type: damageTypes.FIRE, value: 10 }));\r\n// store.dispatch(\r\n//   damageAdded({\r\n//     id: 0,\r\n//     damageCondition: dCond.STRIKE,\r\n//     diceNum: 1,\r\n//     diceSize: 8,\r\n//     staticDamage: 4,\r\n//     damageType: damageTypes.B,\r\n//     material: materials.COLD_IRON,\r\n//     persistent: false,\r\n//   })\r\n// );\r\n// store.dispatch(\r\n//   damageAdded({\r\n//     id: 1,\r\n//     condition: dCond.CRIT,\r\n//     diceNum: 0,\r\n//     diceSize: 8,\r\n//     staticDamage: 10,\r\n//     type: damageTypes.FIRE,\r\n//     material: materials.NONE,\r\n//     persistent: false,\r\n//   })\r\n// );\r\n\r\nexport default store;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport PF2App from './PF2App';\r\nimport store from './store';\r\nimport { Provider } from 'react-redux';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <PF2App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}